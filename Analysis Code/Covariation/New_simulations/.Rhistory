ggtitle("Intergroup Trait Pairings")
intragroup_I<-ggplot(subset(data, trait_name%in%c("virulence-recovery", "contact-infectiousness")), aes(x=t, y=I, group=rep)) +
stat_summary(aes(group=Variance), geom="ribbon", fun.data=mean_cl_normal, alpha=.45, fun.args=list(conf.int=0.95)) +
stat_summary(aes(group=Variance,colour=Variance), geom="line", fun=mean) +
facet_grid(trait_name~cov_sign) +
ylim(0,175) +
xlim(0,75)+
scale_color_manual(values=c("cornflowerblue", "pink", "sienna3"))+
labs(x = "time", y = "average # infected individuals")+
theme_bw()+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
ggtitle("Intragroup Trait Pairings")
var1=c('c','c','c','shed','shed','alpha')
var2=c('shed','alpha','gamma','alpha','gamma','gamma')
i <- 1
data <- vector(mode='list', length=18)
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
z1 = readRDS(paste0(paste("out","R=1",covMatrix,"hivar",var1[j],var2[j],sep="_"),".RDS"))
z2 = readRDS(paste0(paste("out","R=1",covMatrix,"medvar",var1[j],var2[j],sep="_"),".RDS"))
z3 = readRDS(paste0(paste("out","R=1",covMatrix,"lowvar",var1[j],var2[j],sep="_"),".RDS"))
z <- vector(mode='list',length=3)
lapply(1:length(z1), function(i) c(max(z1[[i]][[1]]$I), ## peak epidemic size
sum(sort(z1[[i]][[2]]$numInf,decreasing=TRUE)[1:round(0.2*nrow(z1[[i]][[2]]))])/sum(z1[[i]][[2]]$numInf), ## fraction of cases caused by top 20% of spreaders
ifelse(max(z1[[i]][[1]]$t)>99, glm.nb(z1[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="high",cov=covMatrix, traits=paste(var1[j],var2[j],sep="-")) -> z[[1]]
colnames(z[[1]])[1:4] <- c("peak","top20SS","disp","rep")
lapply(1:length(z2), function(i) c(max(z2[[i]][[1]]$I), ## peak epidemic size
sum(sort(z2[[i]][[2]]$numInf,decreasing=TRUE)[1:round(0.2*nrow(z2[[i]][[2]]))])/sum(z2[[i]][[2]]$numInf), ## fraction of cases caused by top 20% of spreaders
ifelse(max(z2[[i]][[1]]$t)>99, glm.nb(z2[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="med",cov=covMatrix, traits=paste(var1[j],var2[j],sep="-")) -> z[[2]]
colnames(z[[2]])[1:4] <- c("peak","top20SS","disp","rep")
lapply(1:length(z3), function(i) c(max(z3[[i]][[1]]$I), ## peak epidemic size
sum(sort(z3[[i]][[2]]$numInf,decreasing=TRUE)[1:round(0.2*nrow(z3[[i]][[2]]))])/sum(z3[[i]][[2]]$numInf), ## fraction of cases caused by top 20% of spreaders
ifelse(max(z3[[i]][[1]]$t)>99, glm.nb(z3[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="low",cov=covMatrix, traits=paste(var1[j],var2[j],sep="-")) -> z[[3]]
colnames(z[[3]])[1:4] <- c("peak","top20SS","disp","rep")
data[[i]] <- do.call("rbind.data.frame",z)
i <- i+1
}
}
data %>% do.call("rbind.data.frame",.) -> data
# order categories
data$traits<-factor(data$traits, levels=c("alpha-gamma", "c-shed", "c-alpha","c-gamma", "shed-alpha", "shed-gamma"))
##create a column with names rather param symbols
mutate(data, trait_name=ifelse(traits=="alpha-gamma","virulence-recovery",
ifelse(traits=="c-shed","contact-infectiousness",
ifelse(traits=="c-alpha","contact-virulence",
ifelse(traits=="c-gamma","contact-recovery",
ifelse(traits=="shed-alpha","infectiousness-virulence","infectiousness-recovery")))))) %>%
mutate(., cov=ifelse(cov=="nocorr","none",
ifelse(cov=="poscorr","positive","negative"))) %>%
rename(Covariance=cov) %>%
mutate(., Variance=ifelse(Variance=="low", "low",
ifelse(Variance=="med", "moderate", "high"))) -> data
data$Variance<-factor(data$Variance, levels = c("low", "moderate", "high"))
data$trait_name<-factor(data$trait_name, levels=c("virulence-recovery", "contact-infectiousness",
"contact-virulence","contact-recovery", "infectiousness-virulence",
"infectiousness-recovery"))
# create column with covariation signs rather than words
mutate(data, cov_sign=ifelse(Covariance=="negative","(-)",
ifelse(Covariance=="none", "(0)", "(+)")))->data
data$cov_sign<-factor(data$cov_sign,levels=c("(-)", "(0)","(+)"))
# super spreading via dispersion plots, some pairs
intra_k<-ggplot(subset(data, trait_name%in%c("virulence-recovery","contact-infectiousness")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c("cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c("cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intragroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
inter_k<-ggplot(subset(data, trait_name%in%c("contact-recovery","infectiousness-recovery")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
# making colors var and x-cov
inter_peak<-ggplot(subset(data, trait_name%in%c("contact-virulence","contact-recovery", "infectiousness-virulence", "infectiousness-recovery")),aes(x=cov_sign, y=peak,shape=Variance,fill=Variance))+
geom_violin()  +
facet_grid(~trait_name)+
theme_bw()+
labs(y="Peak", x="Covariance")+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 10))
# intragroup trait pairings
intra_peak<- ggplot(subset(data, trait_name%in%c("contact-infectiousness", "virulence-recovery")), aes(x=cov_sign, y=peak,shape=Variance, fill=Variance))+
geom_violin()  +
facet_grid(~trait_name)+
theme_bw()+
labs(y="Peak", x="Covariation")+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
ggtitle("Intragroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 10,  # Right margin
b = 10,  # Bottom margin
l = 10))
dispXpeak_plot<-ggplot(subset(data, trait_name%in%c("virulence-recovery","contact-infectiousness","contact-recovery","infectiousness-recovery")), aes(x=disp, y=peak, shape=Variance, color=Covariance))+
geom_point()+
facet_grid(~trait_name)+
theme_bw()+
labs(y="Peak", x="Dispersion (*k*)")+
scale_color_manual(values=c("cornflowerblue", "pink", "sienna3"))+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 10,  # Right margin
b = 10,  # Bottom margin
l = 10),
panel.spacing.x=unit(5,"mm"),
axis.title.x = ggtext::element_markdown())+
geom_vline(xintercept = 0.16, linetype="dashed")
## pdf of all plots
pdf("R=1_plots.pdf", width=9, height = 7)
print(intragroup_I)
print(intergroup_I)
print(inter_k)
print(intra_k)
print(inter_peak)
print(intra_peak)
print(dispXpeak_plot)
dev.off()
inter_k<-ggplot(subset(data, trait_name%in%c("contact-virulence","contact-recovery", "infectiousness-virulence", "infectiousness-recovery")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
pdf("R=1_plots.pdf", width=9, height = 7)
print(intragroup_I)
print(intergroup_I)
print(inter_k)
print(intra_k)
print(inter_peak)
print(intra_peak)
print(dispXpeak_plot)
dev.off()
ggplot(subset(data, trait_name%in%c("contact-virulence","contact-recovery", "infectiousness-virulence", "infectiousness-recovery")),aes(x=cov_sign, y=peak,shape=Variance,fill=Variance))+
geom_violin()  +
facet_grid(~trait_name)+
theme_bw()+
labs(y="Peak", x="Covariance")+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 10))
ggplot(subset(data, trait_name%in%c("contact-virulence","contact-recovery", "infectiousness-virulence", "infectiousness-recovery")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
ggplot(subset(data, trait_name%in%c("contact-recovery", "infectiousness-virulence", "infectiousness-recovery")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
ggplot(subset(data, trait_name%in%c("contact-virulence", "infectiousness-virulence", "infectiousness-recovery")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
ggplot(subset(data, trait_name%in%c("contact-virulence", "contact-recovery", "infectiousness-recovery")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
ggplot(subset(data, trait_name%in%c("infectiousness-virulence")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
length(subset(data, trait_name%in%c("infectiousness-virulence")))
subset(data, trait_name%in%c("infectiousness-virulence"))
inter_k<-ggplot(subset(data, trait_name%in%c("contact-virulence", "contact-recovery", "infectiousness-recovery")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
inter_k
inter_k1<-ggplot(subset(data, trait_name%in%c("contact-virulence", "contact-recovery", "infectiousness-recovery")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
inter_k_infect_vir<-ggplot(subset(data, trait_name%in%c("infectiousness-virulence")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
inter_k<-ggarrange(inter_k1, inter_k_infect_vir, legend = TRUE)
inter_k
pdf("inter_k_plots.pdf", width = 10, height = 10)
inter_k
inter_k<-ggarrange(inter_k1, inter_k_infect_vir, common.legend = TRUE, ncol=2, nrow=1, legend="right")
inter_k
inter_k_infect_vir<-ggplot(subset(data, trait_name%in%c("infectiousness-virulence")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
inter_k<-ggarrange(inter_k1, inter_k_infect_vir, common.legend = TRUE, ncol=2, nrow=1, legend="right")
inter_k
inter_k<-ggarrange(inter_k1, inter_k_infect_vir, common.legend = TRUE)
inter_k
warnings()
inter_k_infect_vir
ggplot(subset(data, trait_name==("infectiousness-virulence")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
ggplot(subset(data, trait_name="infectiousness-virulence"), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
ggplot(subset(data, trait_name="infectiousness-virulence"), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
ggplot(subset(data, trait_name%in%c("contact-virulence", "contact-recovery", "infectiousness-recovery")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
dev.off()
dev.off()
ggplot(subset(data, trait_name%in%c("contact-virulence", "contact-recovery", "infectiousness-recovery")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=0.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c( "cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
var1=c('c','c','c','shed','shed','alpha')
var2=c('shed','alpha','gamma','alpha','gamma','gamma')
i <- 1
data <- vector(mode='list', length=18)
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
z1 = readRDS(paste0(paste("out","R=1",covMatrix,"hivar",var1[j],var2[j],sep="_"),".RDS"))
z2 = readRDS(paste0(paste("out","R=1",covMatrix,"medvar",var1[j],var2[j],sep="_"),".RDS"))
z3 = readRDS(paste0(paste("out","R=1",covMatrix,"lowvar",var1[j],var2[j],sep="_"),".RDS"))
z <- vector(mode='list',length=3)
lapply(1:length(z1), function(i) c(max(z1[[i]][[1]]$I), ## peak epidemic size
sum(sort(z1[[i]][[2]]$numInf,decreasing=TRUE)[1:round(0.2*nrow(z1[[i]][[2]]))])/sum(z1[[i]][[2]]$numInf), ## fraction of cases caused by top 20% of spreaders
ifelse(max(z1[[i]][[1]]$t)>99, glm.nb(z1[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="high",cov=covMatrix, traits=paste(var1[j],var2[j],sep="-")) -> z[[1]]
colnames(z[[1]])[1:4] <- c("peak","top20SS","disp","rep")
lapply(1:length(z2), function(i) c(max(z2[[i]][[1]]$I), ## peak epidemic size
sum(sort(z2[[i]][[2]]$numInf,decreasing=TRUE)[1:round(0.2*nrow(z2[[i]][[2]]))])/sum(z2[[i]][[2]]$numInf), ## fraction of cases caused by top 20% of spreaders
ifelse(max(z2[[i]][[1]]$t)>99, glm.nb(z2[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="med",cov=covMatrix, traits=paste(var1[j],var2[j],sep="-")) -> z[[2]]
colnames(z[[2]])[1:4] <- c("peak","top20SS","disp","rep")
lapply(1:length(z3), function(i) c(max(z3[[i]][[1]]$I), ## peak epidemic size
sum(sort(z3[[i]][[2]]$numInf,decreasing=TRUE)[1:round(0.2*nrow(z3[[i]][[2]]))])/sum(z3[[i]][[2]]$numInf), ## fraction of cases caused by top 20% of spreaders
ifelse(max(z3[[i]][[1]]$t)>99, glm.nb(z3[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="low",cov=covMatrix, traits=paste(var1[j],var2[j],sep="-")) -> z[[3]]
colnames(z[[3]])[1:4] <- c("peak","top20SS","disp","rep")
data[[i]] <- do.call("rbind.data.frame",z)
i <- i+1
}
}
data %>% do.call("rbind.data.frame",.) -> data
# order categories
data$traits<-factor(data$traits, levels=c("alpha-gamma", "c-shed", "c-alpha","c-gamma", "shed-alpha", "shed-gamma"))
##create a column with names rather param symbols
mutate(data, trait_name=ifelse(traits=="alpha-gamma","virulence-recovery",
ifelse(traits=="c-shed","contact-infectiousness",
ifelse(traits=="c-alpha","contact-virulence",
ifelse(traits=="c-gamma","contact-recovery",
ifelse(traits=="shed-alpha","infectiousness-virulence","infectiousness-recovery")))))) %>%
mutate(., cov=ifelse(cov=="nocorr","none",
ifelse(cov=="poscorr","positive","negative"))) %>%
rename(Covariance=cov) %>%
mutate(., Variance=ifelse(Variance=="low", "low",
ifelse(Variance=="med", "moderate", "high"))) -> data
data$Variance<-factor(data$Variance, levels = c("low", "moderate", "high"))
data$trait_name<-factor(data$trait_name, levels=c("virulence-recovery", "contact-infectiousness",
"contact-virulence","contact-recovery", "infectiousness-virulence",
"infectiousness-recovery"))
# create column with covariation signs rather than words
mutate(data, cov_sign=ifelse(Covariance=="negative","(-)",
ifelse(Covariance=="none", "(0)", "(+)")))->data
data$cov_sign<-factor(data$cov_sign,levels=c("(-)", "(0)","(+)"))
ggplot(subset(data, trait_name%in%c("virulence-recovery","contact-infectiousness")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=.9)+
facet_grid(cov_sign~trait_name)+
theme_bw()+
scale_color_manual(values=c("cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c("cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (*k*)")+
ggtitle("Intragroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
geom_vline(xintercept = 0.16, linetype="dashed")+
theme(axis.title.x = ggtext::element_markdown())
