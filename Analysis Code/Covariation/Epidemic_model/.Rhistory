theta_meta_f <- -5.55e6
theta_paed <- 4.41e6
x0 <- 3.5
T <- c(200,500,1000)
dd_sims <- lapply(T, function(t) sapply(1:40, function(i) ornstein_uhlenbeck(t, t*10, theta_dd, alpha, sig_dd, x0)))
meta_nf_sims <- lapply(T, function(t) sapply(1:40, function(i) ornstein_uhlenbeck(t, t*10, theta_meta_nf, alpha, sig_meta_nf, x0)))
meta_f_sims <- lapply(T, function(t) sapply(1:40, function(i) ornstein_uhlenbeck(t, t*10, theta_meta_f, alpha, sig_meta_f, x0)))
paed_sims <- lapply(T, function(t) sapply(1:40, function(i) ornstein_uhlenbeck(t, t*10, theta_paed, alpha, sig_paed, x0)))
par(mfrow=c(4,3), mar=c(3,3,0,0), oma=rep(1,4))
for (j in 1:3) {
plot.new()
plot.window(xlim=c(0,T[j]), ylim=range(dd_sims))
axis(1);axis(2);box('plot')
for(i in 1:40)
lines(seq(0,T[j],0.1), dd_sims[[j]][,i])
lines(seq(0,T[j],0.1), apply(dd_sims[[j]], 1, mean), col=2, lwd=2)
}
png(filename="~/Desktop/OU_simulations_of_salamander_parameters", height=10, width=8, units='in', res=450)
par(mfrow=c(4,3), mar=c(3,3,0,0), oma=rep(1,4))
for (j in 1:3) {
plot.new()
plot.window(xlim=c(0,T[j]), ylim=range(dd_sims))
axis(1);axis(2);box('plot')
if (j==1) mtext(side=2, line=3, "dd")
for(i in 1:40)
lines(seq(0,T[j],0.1), dd_sims[[j]][,i])
lines(seq(0,T[j],0.1), apply(dd_sims[[j]], 1, mean), col=2, lwd=2)
}
for (j in 1:3) {
plot.new()
plot.window(xlim=c(0,T[j]), ylim=range(meta_nf_sims))
axis(1);axis(2);box('plot')
if (j==1) mtext(side=2, line=3, "meta_nf")
for(i in 1:40)
lines(seq(0,T[j],0.1), meta_nf_sims[[j]][,i])
lines(seq(0,T[j],0.1), apply(meta_nf_sims[[j]], 1, mean), col=2, lwd=2)
}
for (j in 1:3) {
plot.new()
plot.window(xlim=c(0,T[j]), ylim=range(meta_f_sims))
axis(1);axis(2);box('plot')
if (j==1) mtext(side=2, line=3, "meta_f")
for(i in 1:40)
lines(seq(0,T[j],0.1), meta_f_sims[[j]][,i])
lines(seq(0,T[j],0.1), apply(meta_f_sims[[j]], 1, mean), col=2, lwd=2)
}
for (j in 1:3) {
plot.new()
plot.window(xlim=c(0,T[j]), ylim=range(paed_sims))
axis(1);axis(2);box('plot')
if (j==1) mtext(side=2, line=3, "paed")
for(i in 1:40)
lines(seq(0,T[j],0.1), paed_sims[[j]][,i])
lines(seq(0,T[j],0.1), apply(paed_sims[[j]], 1, mean), col=2, lwd=2)
}
dev.off()
png(filename="~/Desktop/OU_simulations_of_salamander_parameters.png", height=10, width=8, units='in', res=450)
par(mfrow=c(4,3), mar=c(3,3,0,0), oma=rep(1,4))
for (j in 1:3) {
plot.new()
plot.window(xlim=c(0,T[j]), ylim=range(dd_sims))
axis(1);axis(2);box('plot')
if (j==1) mtext(side=2, line=3, "dd")
for(i in 1:40)
lines(seq(0,T[j],0.1), dd_sims[[j]][,i])
lines(seq(0,T[j],0.1), apply(dd_sims[[j]], 1, mean), col=2, lwd=2)
}
for (j in 1:3) {
plot.new()
plot.window(xlim=c(0,T[j]), ylim=range(meta_nf_sims))
axis(1);axis(2);box('plot')
if (j==1) mtext(side=2, line=3, "meta_nf")
for(i in 1:40)
lines(seq(0,T[j],0.1), meta_nf_sims[[j]][,i])
lines(seq(0,T[j],0.1), apply(meta_nf_sims[[j]], 1, mean), col=2, lwd=2)
}
for (j in 1:3) {
plot.new()
plot.window(xlim=c(0,T[j]), ylim=range(meta_f_sims))
axis(1);axis(2);box('plot')
if (j==1) mtext(side=2, line=3, "meta_f")
for(i in 1:40)
lines(seq(0,T[j],0.1), meta_f_sims[[j]][,i])
lines(seq(0,T[j],0.1), apply(meta_f_sims[[j]], 1, mean), col=2, lwd=2)
}
for (j in 1:3) {
plot.new()
plot.window(xlim=c(0,T[j]), ylim=range(paed_sims))
axis(1);axis(2);box('plot')
if (j==1) mtext(side=2, line=3, "paed")
for(i in 1:40)
lines(seq(0,T[j],0.1), paed_sims[[j]][,i])
lines(seq(0,T[j],0.1), apply(paed_sims[[j]], 1, mean), col=2, lwd=2)
}
dev.off()
9.02e-8*(2540000-3.7)
0.02/5
setwd("~/newGEM_SIR/Analysis Code/Covariation/Epidemic_model")
j =
1
covMatrix = "nocorr"
varLevel = "hivar"
j = 4
nocorr <- matrix(c(1,0,0,1), nrow=2, byrow=T)
negcorr <- matrix(c(1,-.5,-.5,1), nrow=2, byrow=T)
poscorr <- matrix(c(1,.5,.5,1), nrow=2, byrow=T)
hivar = c(   c=0.1,    shed=0.05,    alpha=0.1,    gamma=0.1,
sd_c=0.5, sd_shed=0.25, sd_alpha=0.5, sd_gamma=0.5)
medvar = c(   c=0.1,    shed=0.05,    alpha=0.1,    gamma=0.1,
sd_c=0.1, sd_shed=0.05, sd_alpha=0.1, sd_gamma=0.1)
lowvar = c(   c=0.1,     shed=0.05,    alpha=0.1,     gamma=0.1,
sd_c=0.02, sd_shed=0.01, sd_alpha=0.02, sd_gamma=0.02)
x <- readRDS(paste0(paste("out",covMatrix,varLevel,var1[j],var2[j],sep="_"),".RDS"))
var1=c('c','c','c','shed','shed','alpha')
var2=c('shed','alpha','gamma','alpha','gamma','gamma')
x <- readRDS(paste0(paste("out",covMatrix,varLevel,var1[j],var2[j],sep="_"),".RDS"))
x
x[[1]][[1]]
x[[1]][[1]]$I
max(x[[1]][[1]]$I)
## extract some key information from this
lapply(x, function(i) max(i[[1]]$I))
## extract some key information from this
lapply(x, function(i) max(i[[1]]$I)) %>% unlist
library(tidyverse)
## extract some key information from this
lapply(x, function(i) max(i[[1]]$I)) %>% unlist
## extract some key information from this
data.frame(epidemicPeak=lapply(x, function(i) max(i[[1]]$I)) %>% unlist,
timeToPeak=lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist)
paste(var1[j],var2[j])
summary <- list()
it <- 1
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
for (varLevel in c("hivar","medvar","lowvar")) {
x <- readRDS(paste0(paste("out",covMatrix,varLevel,var1[j],var2[j],sep="_"),".RDS"))
## extract some key information from this
data.frame(traits=paste(var1[j],var2[j],sep=","),
cov=CovMatrix,
var=varLevel,
epidemicPeak=lapply(x, function(i) max(i[[1]]$I)) %>% unlist,
timeToPeak=lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist) -> summary[[it]]
it <- it + 1
}
}
}
summary <- list()
it <- 1
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
for (varLevel in c("hivar","medvar","lowvar")) {
x <- readRDS(paste0(paste("out",covMatrix,varLevel,var1[j],var2[j],sep="_"),".RDS"))
## extract some key information from this
data.frame(traits=paste(var1[j],var2[j],sep=","),
cov=covMatrix,
var=varLevel,
epidemicPeak=lapply(x, function(i) max(i[[1]]$I)) %>% unlist,
timeToPeak=lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist) -> summary[[it]]
it <- it + 1
}
}
}
summary
summary <- do.call("rbind.data.frame", summary)
dim(summary)
ggplot(summary, aes(x=var, y=epidemicPeak, group=cov)) +
boxplot() +
facet_wrap(~traits, nrow=2) +
theme_bw()
?ggplot2::boxplot
??boxplot
ggplot(summary, aes(x=var, y=epidemicPeak, group=cov)) +
boxplot()
ggplot(subset(summary,traits=="alpha,gamma"), aes(x=var, y=epidemicPeak)) +
boxplot() +
facet_wrap(~cov)
ggplot(subset(summary,traits=="alpha,gamma"), aes(x=var, y=epidemicPeak, group=cov)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
theme_bw()
ggplot(summary, aes(x=var, y=epidemicPeak, group=cov)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
theme_bw()
ggplot(summary, aes(x=var, y=epidemicPeak, group=cov, colour=cov)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
theme_bw()
ggplot(summary, aes(x=as.factor(var), y=epidemicPeak, group=cov, colour=cov)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
theme_bw()
ggplot(subset(summary, cov="nocorr"), aes(x=as.factor(var), y=epidemicPeak)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
theme_bw()
ggplot(summary, aes(x=as.factor(var), y=epidemicPeak, group=as.factor(cov))) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
theme_bw()
covMatrix
strsplit(covMatrix,"corr")
strsplit(covMatrix,"corr")[[1]][1]
varLevel
strsplit(varLevel,"var")[[1]][1]
summary <- list()
it <- 1
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
for (varLevel in c("hivar","medvar","lowvar")) {
x <- readRDS(paste0(paste("out",covMatrix,varLevel,var1[j],var2[j],sep="_"),".RDS"))
## extract some key information from this
data.frame(traits=paste(var1[j],var2[j],sep=","),
cov=covMatrix,
var=varLevel,
covvar=paste(strsplit(varLevel,"var")[[1]][1],strsplit(covMatrix,"corr")[[1]][1],sep="-"),
epidemicPeak=lapply(x, function(i) max(i[[1]]$I)) %>% unlist,
timeToPeak=lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist) -> summary[[it]]
it <- it + 1
}
}
}
summary <- do.call("rbind.data.frame", summary)
ggplot(summary, aes(x=covvar, y=epidemicPeak)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
theme_bw()
ggplot(summary, aes(x=covvar, y=epidemicPeak)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
paste(strsplit(varLevel,"var")[[1]][1],strsplit(covMatrix,"corr")[[1]][1],sep="-")
rev(paste(strsplit(varLevel,"var")[[1]][1],strsplit(covMatrix,"corr")[[1]][1],sep="-"))
summary <- list()
it <- 1
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
for (varLevel in c("hivar","medvar","lowvar")) {
x <- readRDS(paste0(paste("out",covMatrix,varLevel,var1[j],var2[j],sep="_"),".RDS"))
## extract some key information from this
data.frame(traits=paste(var1[j],var2[j],sep=","),
cov=covMatrix,
var=varLevel,
varcov=paste(strsplit(varLevel,"var")[[1]][1],strsplit(covMatrix,"corr")[[1]][1],sep="-"),
covvar=paste(strsplit(covMatrix,"corr")[[1]][1],strsplit(varLevel,"var")[[1]][1],sep="-"),
epidemicPeak=lapply(x, function(i) max(i[[1]]$I)) %>% unlist,
timeToPeak=lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist) -> summary[[it]]
it <- it + 1
}
}
}
summary <- do.call("rbind.data.frame", summary)
ggplot(summary, aes(x=covvar, y=epidemicPeak)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
ggplot(summary, aes(x=varcov, y=epidemicPeak)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
levels(summary$varcov)
levels(as.factor(summary$varcov))
?as.factor
levels(as.factor(summary$covvar))
mutate(summary,
covvar=factor(covvar, levels=c("low-neg","low-no","low-pos","med-neg","med-no","med-pos","hi-neg","hi-no","hi-pos")),
varcov=factor(varcov, levels=c("neg-low","neg-med","neg-hi","no-low","no-med","no-hi","pos-low","pos-med","pos-hi")))
summary <- list()
it <- 1
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
for (varLevel in c("hivar","medvar","lowvar")) {
x <- readRDS(paste0(paste("out",covMatrix,varLevel,var1[j],var2[j],sep="_"),".RDS"))
## extract some key information from this
data.frame(traits=paste(var1[j],var2[j],sep=","),
cov=covMatrix,
var=varLevel,
varcov=paste(strsplit(varLevel,"var")[[1]][1],strsplit(covMatrix,"corr")[[1]][1],sep="-"),
covvar=paste(strsplit(covMatrix,"corr")[[1]][1],strsplit(varLevel,"var")[[1]][1],sep="-"),
epidemicPeak=lapply(x, function(i) max(i[[1]]$I)) %>% unlist,
timeToPeak=lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist) -> summary[[it]]
it <- it + 1
}
}
}
summary <- do.call("rbind.data.frame", summary)
mutate(summary,
covvar=factor(covvar, levels=c("low-neg","low-no","low-pos","med-neg","med-no","med-pos","hi-neg","hi-no","hi-pos")),
varcov=factor(varcov, levels=c("neg-low","neg-med","neg-hi","no-low","no-med","no-hi","pos-low","pos-med","pos-hi"))) -> summary
ggplot(summary, aes(x=covvar, y=epidemicPeak)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
head(summary)
summary <- list()
it <- 1
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
for (varLevel in c("hivar","medvar","lowvar")) {
x <- readRDS(paste0(paste("out",covMatrix,varLevel,var1[j],var2[j],sep="_"),".RDS"))
## extract some key information from this
data.frame(traits=paste(var1[j],var2[j],sep=","),
cov=covMatrix,
var=varLevel,
varcov=paste(strsplit(varLevel,"var")[[1]][1],strsplit(covMatrix,"corr")[[1]][1],sep="-"),
covvar=paste(strsplit(covMatrix,"corr")[[1]][1],strsplit(varLevel,"var")[[1]][1],sep="-"),
epidemicPeak=lapply(x, function(i) max(i[[1]]$I)) %>% unlist,
timeToPeak=lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist) -> summary[[it]]
it <- it + 1
}
}
}
summary <- do.call("rbind.data.frame", summary)
factor(summary$covvar, levels=c("low-neg","low-no","low-pos","med-neg","med-no","med-pos","hi-neg","hi-no","hi-pos"))
as.factor(summary$covvar, levels=c("low-neg","low-no","low-pos","med-neg","med-no","med-pos","hi-neg","hi-no","hi-pos"))
factor(summary$covvar)
mutate(summary,
covvar=factor(varcov, levels=c("low-neg","low-no","low-pos","med-neg","med-no","med-pos","hi-neg","hi-no","hi-pos")),
varcov=factor(covvar, levels=c("neg-low","neg-med","neg-hi","no-low","no-med","no-hi","pos-low","pos-med","pos-hi"))) -> summary
head(summary)
factor(varcov, levels=c("low-neg","low-no","low-pos","med-neg","med-no","med-pos","hi-neg","hi-no","hi-pos"))
summary <- list()
it <- 1
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
for (varLevel in c("hivar","medvar","lowvar")) {
x <- readRDS(paste0(paste("out",covMatrix,varLevel,var1[j],var2[j],sep="_"),".RDS"))
## extract some key information from this
data.frame(traits=paste(var1[j],var2[j],sep=","),
cov=covMatrix,
var=varLevel,
varcov=paste(strsplit(varLevel,"var")[[1]][1],strsplit(covMatrix,"corr")[[1]][1],sep="-"),
covvar=paste(strsplit(covMatrix,"corr")[[1]][1],strsplit(varLevel,"var")[[1]][1],sep="-"),
epidemicPeak=lapply(x, function(i) max(i[[1]]$I)) %>% unlist,
timeToPeak=lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist) -> summary[[it]]
it <- it + 1
}
}
}
summary <- do.call("rbind.data.frame", summary)
factor(summary$varcov, levels=c("low-neg","low-no","low-pos","med-neg","med-no","med-pos","hi-neg","hi-no","hi-pos"))
factor(summary$covvar, levels=c("neg-low","neg-med","neg-hi","no-low","no-med","no-hi","pos-low","pos-med","pos-hi"))
mutate(summary,
covvar=factor(varcov, levels=c("low-neg","low-no","low-pos","med-neg","med-no","med-pos","hi-neg","hi-no","hi-pos")),
varcov=factor(covvar, levels=c("neg-low","neg-med","neg-hi","no-low","no-med","no-hi","pos-low","pos-med","pos-hi"))) -> summary
summary <- list()
it <- 1
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
for (varLevel in c("hivar","medvar","lowvar")) {
x <- readRDS(paste0(paste("out",covMatrix,varLevel,var1[j],var2[j],sep="_"),".RDS"))
## extract some key information from this
data.frame(traits=paste(var1[j],var2[j],sep=","),
cov=covMatrix,
var=varLevel,
varcov=paste(strsplit(varLevel,"var")[[1]][1],strsplit(covMatrix,"corr")[[1]][1],sep="-"),
covvar=paste(strsplit(covMatrix,"corr")[[1]][1],strsplit(varLevel,"var")[[1]][1],sep="-"),
epidemicPeak=lapply(x, function(i) max(i[[1]]$I)) %>% unlist,
timeToPeak=lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist) -> summary[[it]]
it <- it + 1
}
}
}
summary <- do.call("rbind.data.frame", summary)
mutate(summary,
varcov=factor(varcov, levels=c("low-neg","low-no","low-pos","med-neg","med-no","med-pos","hi-neg","hi-no","hi-pos")),
covvar=factor(covvar, levels=c("neg-low","neg-med","neg-hi","no-low","no-med","no-hi","pos-low","pos-med","pos-hi"))) -> summary
ggplot(summary, aes(x=covvar, y=epidemicPeak)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
ggplot(summary, aes(x=varcov, y=epidemicPeak)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
ggplot(summary, aes(x=covvar, y=timeToPeak)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
ggplot(summary, aes(x=varcov, y=timeToPeak)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
x <- readRDS(paste0(paste("out",covMatrix,varLevel,var1[j],var2[j],sep="_"),".RDS"))
lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist)
(lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist)
t = (lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist)
t[1]
x[[1]][[1]]
x[[1]][[2]]
x[[1]][[2]]$tInf
x[[1]][[2]]$tInf < t[1]
x[[1]][[2]]
x[[1]][[2]]$numInf
max(x[[1]][[2]]$numInf)
median(x[[1]][[2]]$numInf)
mean(x[[1]][[2]]$numInf)
mean(x[[1]][[2]]$numInf)+2*sd(x[[1]][[2]]$numInf)
x[[1]][[[2]]$numInf > mean(x[[1]][[2]]$numInf)+2*sd(x[[1]][[2]]$numInf)
x[[1]][[2]]$numInf > mean(x[[1]][[2]]$numInf)+2*sd(x[[1]][[2]]$numInf)
sum(x[[1]][[2]]$numInf > mean(x[[1]][[2]]$numInf)+2*sd(x[[1]][[2]]$numInf))
sum(x[[1]][[2]]$numInf > mean(x[[1]][[2]]$numInf)+2*sd(x[[1]][[2]]$numInf))/(nrow(x[[1]][[2]]-1))
summary <- list()
it <- 1
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
for (varLevel in c("hivar","medvar","lowvar")) {
x <- readRDS(paste0(paste("out",covMatrix,varLevel,var1[j],var2[j],sep="_"),".RDS"))
## extract some key information from this
data.frame(traits=paste(var1[j],var2[j],sep=","),
cov=covMatrix,
var=varLevel,
varcov=paste(strsplit(varLevel,"var")[[1]][1],strsplit(covMatrix,"corr")[[1]][1],sep="-"),
covvar=paste(strsplit(covMatrix,"corr")[[1]][1],strsplit(varLevel,"var")[[1]][1],sep="-"),
epidemicPeak=lapply(x, function(i) max(i[[1]]$I)) %>% unlist,
timeToPeak=lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist,
maxSpreader=max(i[[2]]$numInf),
fracSS=sum(i[[2]]$numInf > mean(i[[2]]$numInf)+2*sd(i[[2]]$numInf))/(nrow(i[[2]]-1)),
fracZero=sum(i[[2]]$numInf==0)/(nrow(i[[2]]-1))) -> summary[[it]]
it <- it + 1
}
}
}
summary <- list()
it <- 1
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
for (varLevel in c("hivar","medvar","lowvar")) {
x <- readRDS(paste0(paste("out",covMatrix,varLevel,var1[j],var2[j],sep="_"),".RDS"))
## extract some key information from this
data.frame(traits=paste(var1[j],var2[j],sep=","),
cov=covMatrix,
var=varLevel,
varcov=paste(strsplit(varLevel,"var")[[1]][1],strsplit(covMatrix,"corr")[[1]][1],sep="-"),
covvar=paste(strsplit(covMatrix,"corr")[[1]][1],strsplit(varLevel,"var")[[1]][1],sep="-"),
epidemicPeak=lapply(x, function(i) max(i[[1]]$I)) %>% unlist,
timeToPeak=lapply(x,function(i) i[[1]]$t[which.max(i[[1]]$I)]) %>% unlist,
maxSpreader=lapply(x, function(i) max(i[[2]]$numInf)) %>% unlist,
fracSS=lapply(x, function(i) sum(i[[2]]$numInf > mean(i[[2]]$numInf)+2*sd(i[[2]]$numInf))/(nrow(i[[2]]-1))) %>% unlist,
fracZero=lapply(x, function(i) sum(i[[2]]$numInf==0)/(nrow(i[[2]]-1))) %>% unlist) -> summary[[it]]
it <- it + 1
}
}
}
summary <- do.call("rbind.data.frame", summary)
mutate(summary,
varcov=factor(varcov, levels=c("low-neg","low-no","low-pos","med-neg","med-no","med-pos","hi-neg","hi-no","hi-pos")),
covvar=factor(covvar, levels=c("neg-low","neg-med","neg-hi","no-low","no-med","no-hi","pos-low","pos-med","pos-hi"))) -> summary
head(summary)
ggplot(summary, aes(x=covvar, y=fracSS)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
ggplot(summary, aes(x=varcov, y=fracSS)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
ggplot(summary, aes(x=varcov, y=fracZero)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
ggplot(summary, aes(x=varcov, y=epidemicPeak)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
ggplot(summary, aes(x=varcov, y=timeToPeak)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
ggplot(summary, aes(x=varcov, y=fracSS)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
ggplot(summary, aes(x=varcov, y=fracZero)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
ggplot(summary, aes(x=varcov, y=maxSpreader)) +
geom_boxplot() +
facet_wrap(~traits, nrow=2) +
scale_x_discrete(guide = guide_axis(angle = 90)) +
theme_bw()
head(summary)
with(subset(summary,traits=="c,shed" & cov=="nocorr" & var=="hivar"), plot(maxSpreader, epidemicPeak))
with(subset(summary,traits=="c,alpha" & cov=="nocorr" & var=="hivar"), plot(maxSpreader, epidemicPeak))
with(subset(summary,traits=="alpha,gamma" & cov=="nocorr" & var=="hivar"), plot(maxSpreader, epidemicPeak))
with(subset(summary,traits=="c,alpha" & cov=="nocorr" & var=="hivar"), plot(maxSpreader, epidemicPeak))
with(subset(summary,traits=="c,alpha" & cov=="nocorr" & var=="medvar"), plot(maxSpreader, epidemicPeak))
with(subset(summary,traits=="c,shed" & cov=="nocorr" & var=="medvar"), plot(maxSpreader, epidemicPeak))
with(subset(summary,traits=="c,shed" & cov=="nocorr" & var=="hivar"), plot(maxSpreader, epidemicPeak))
with(subset(summary,traits=="c,alpha" & cov=="nocorr" & var=="hivar"), plot(maxSpreader, epidemicPeak))
with(subset(summary,traits=="c,alpha" & cov=="nocorr" & var=="medvar"), plot(maxSpreader, epidemicPeak))
with(subset(summary,traits=="c,alpha" & cov=="nocorr" & var=="lovar"), plot(maxSpreader, epidemicPeak))
with(subset(summary,traits=="c,alpha" & cov=="nocorr" & var=="lowvar"), plot(maxSpreader, epidemicPeak))
with(subset(summary,traits=="c,alpha" & cov=="poscorr" & var=="hivar"), plot(maxSpreader, epidemicPeak))
with(subset(summary,traits=="c,shed" & cov=="nocorr" & var=="lowvar"), plot(maxSpreader, epidemicPeak))
