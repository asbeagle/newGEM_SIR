out_negcorr_hivar_alpha_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_hivar_alpha_gamma.RDS")
out_nocorr_hivar_alpha_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_hivar_alpha_gamma.RDS")
out_nocorr_hivar_alpha_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_hivar_alpha_gamma.RDS")
out_poscorr_hivar_alpha_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_hivar_alpha_gamma.RDS")
out_negcorr_medvar_alpha_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_medvar_alpha_gamma.RDS")
out_nocorr_medvar_alpha_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_medvar_alpha_gamma.RDS")
out_poscorr_medvar_alpha_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_medvar_alpha_gamma.RDS")
out_negcorr_lowvar_alpha_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_lowvar_alpha_gamma.RDS")
out_nocorr_lowvar_alpha_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_lowvar_alpha_gamma.RDS")
out_poscorr_lowvar_alpha_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_lowvar_alpha_gamma.RDS")
out_negcorr_hivar_c_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_hivar_c_alpha.RDS")
out_nocorr_hivar_c_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_hivar_c_alpha.RDS")
out_poscorr_hivar_c_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_hivar_c_alpha.RDS")
out_negcorr_medvar_c_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_medvar_c_alpha.RDS")
out_nocorr_medvar_c_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_medvar_c_alpha.RDS")
out_poscorr_medvar_c_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_medvar_c_alpha.RDS")
out_negcorr_lowvar_c_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_lowvar_c_alpha.RDS")
out_nocorr_lowvar_c_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_lowvar_c_alpha.RDS")
out_poscorr_lowvar_c_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_lowvar_c_alpha.RDS")
out_negcorr_hivar_c_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_hivar_c_gamma.RDS")
out_nocorr_hivar_c_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_hivar_c_gamma.RDS")
out_poscorr_hivar_c_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_hivar_c_gamma.RDS")
# med var
out_negcorr_medvar_c_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_medvar_c_gamma.RDS")
out_nocorr_medvar_c_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_medvar_c_gamma.RDS")
out_poscorr_medvar_c_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_medvar_c_gamma.RDS")
# low var
out_negcorr_lowvar_c_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_lowvar_c_gamma.RDS")
out_nocorr_lowvar_c_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_lowvar_c_gamma.RDS")
out_poscorr_lowvar_c_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_lowvar_c_gamma.RDS")
out_negcorr_hivar_c_shed <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_hivar_c_shed.RDS")
out_nocorr_hivar_c_shed <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_hivar_c_shed.RDS")
out_poscorr_hivar_c_shed <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_hivar_c_shed.RDS")
# med var
out_negcorr_medvar_c_shed <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_medvar_c_shed.RDS")
out_nocorr_medvar_c_shed <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_medvar_c_shed.RDS")
out_poscorr_medvar_c_shed <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_medvar_c_shed.RDS")
# low var
out_negcorr_lowvar_c_shed <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_lowvar_c_shed.RDS")
out_nocorr_lowvar_c_shed <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_lowvar_c_shed.RDS")
out_poscorr_lowvar_c_shed <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_lowvar_c_shed.RDS")
out_negcorr_hivar_shed_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_hivar_shed_alpha.RDS")
## shed alpha
# hi var
out_negcorr_hivar_shed_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_hivar_shed_alpha.RDS")
out_nocorr_hivar_shed_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_hivar_shed_alpha.RDS")
out_poscorr_hivar_shed_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_hivar_shed_alpha.RDS")
# med var
out_negcorr_medvar_shed_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_medvar_shed_alpha.RDS")
out_nocorr_medvar_shed_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_medvar_shed_alpha.RDS")
out_poscorr_medvar_shed_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_medvar_shed_alpha.RDS")
out_negcorr_lowvar_shed_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_lowvar_shed_alpha.RDS")
out_nocorr_lowvar_shed_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_lowvar_shed_alpha.RDS")
out_poscorr_lowvar_shed_alpha <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_lowvar_shed_alpha.RDS")
out_negcorr_hivar_shed_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_hivar_shed_gamma.RDS")
out_nocorr_hivar_shed_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_hivar_shed_gamma.RDS")
out_poscorr_hivar_shed_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_hivar_shed_gamma.RDS")
# med var
out_negcorr_medvar_shed_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_medvar_shed_gamma.RDS")
out_nocorr_medvar_shed_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_medvar_shed_gamma.RDS")
out_poscorr_medvar_shed_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_medvar_shed_gamma.RDS")
# low var
out_negcorr_lowvar_shed_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_negcorr_lowvar_shed_gamma.RDS")
out_nocorr_lowvar_shed_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_nocorr_lowvar_shed_gamma.RDS")
out_poscorr_lowvar_shed_gamma <- readRDS("~/newGEM_SIR/Analysis Code/Covariation/out_poscorr_lowvar_shed_gamma.RDS")
library(reticulate)
installed.packages()
1/.002
500/2
1/.000018
597*.1575
597*.1575+(597)
setwd("/Users/alexisbeagle/newGEM_SIR/Analysis Code/Covariation/New_simulations")
library(tidyverse)
library(MASS)
library(ggplot2)
library(cowplot)
library(ggpubr)
library(ggtext)
library(magrittr)
setwd("/Users/alexisbeagle/newGEM_SIR/Trait_covariance_simulations_and_data_analysis")
library(tidyverse)
library(magrittr)
library(MASS)
9-4
1400+1200+600+300+1246+400+246+700+287
6379+800+3500+2450
800+3500+2450
library(tidyverse)
library(magrittr)
library(MASS)
## Empirical cumulative density function plots
## (Technically, 1-ECDF!)
## R0 = 1 plots
var1=c('c',    'c',    'shed', 'shed', 'c',   'alpha')
var2=c('gamma','alpha','gamma','alpha','shed','gamma')
i <- 1
data <- vector(mode='list', length=18)
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
z1 = readRDS(paste0(paste("out_R=1",covMatrix,"hivar",var1[j],var2[j],sep="_"),".RDS"))
z2 = readRDS(paste0(paste("out_R=1",covMatrix,"medvar",var1[j],var2[j],sep="_"),".RDS"))
z3 = readRDS(paste0(paste("out_R=1",covMatrix,"lowvar",var1[j],var2[j],sep="_"),".RDS"))
## Provide a label for each plot panel
panel <- paste0(LETTERS[j],switch(covMatrix,poscorr="(3)",negcorr="(1)",nocorr="(2)"))
## Give nicer names
covMatrix <- switch(covMatrix,poscorr="(+) Cov",negcorr="(-) Cov",nocorr="(0) Cov")
trait1 <- switch(var1[j],c="Contact",shed="Infectiousness",alpha="Virulence")
trait2 <- switch(var2[j],shed="Infectiousness",alpha="Virulence",gamma="Recovery")
z <- vector(mode='list',length=3)
lapply(1:length(z1), function(i) data.frame(peakSize=max(z1[[i]][[1]]$I,na.rm=TRUE), ## peak epidemic size
peakPrev=max(z1[[i]][[1]]$I/(z1[[i]][[1]]$S+z1[[i]][[1]]$I+z1[[i]][[1]]$R),na.rm=TRUE),
disp=ifelse(max(z1[[i]][[1]]$t)>99, glm.nb(z1[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
fadeout=ifelse(length(z1[[i]][[1]]$t)<99, 1, 0), # binary: did this replicate go extinct?
rep=i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="high",cov=covMatrix, traits=paste(trait1,trait2,sep="-"), panelLab=panel) -> z[[1]]
lapply(1:length(z2), function(i) data.frame(peakSize=max(z2[[i]][[1]]$I,na.rm=TRUE), ## peak epidemic size
peakPrev=max(z2[[i]][[1]]$I/(z2[[i]][[1]]$S+z2[[i]][[1]]$I+z2[[i]][[1]]$R),na.rm=TRUE),
disp=ifelse(max(z2[[i]][[1]]$t)>99, glm.nb(z2[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
fadeout=ifelse(length(z2[[i]][[1]]$t)<99, 1, 0),
rep=i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="med",cov=covMatrix, traits=paste(trait1,trait2,sep="-"), panelLab=panel) -> z[[2]]
lapply(1:length(z3), function(i) data.frame(peakSize=max(z3[[i]][[1]]$I,na.rm=TRUE), ## peak epidemic size
peakPrev=max(z3[[i]][[1]]$I/(z3[[i]][[1]]$S+z3[[i]][[1]]$I+z3[[i]][[1]]$R),na.rm=TRUE),
disp=ifelse(max(z3[[i]][[1]]$t)>99, glm.nb(z3[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
fadeout=ifelse(length(z3[[i]][[1]]$t)<99, 1, 0),
rep=i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="low",cov=covMatrix, traits=paste(trait1,trait2,sep="-"), panelLab=panel) -> z[[3]]
data[[i]] <- do.call("rbind.data.frame",z)
i <- i+1
}
}
data <- do.call("rbind.data.frame",data)
data$cov <- factor(data$cov, levels=c("(-) Cov","(0) Cov","(+) Cov"))
data$Variance <- factor(data$Variance, levels=c("low","med","high"))
data$traits <- factor(data$traits, levels=c("Contact-Recovery","Contact-Virulence","Infectiousness-Recovery","Infectiousness-Virulence","Contact-Infectiousness","Virulence-Recovery"))
# compute the fraction of replicates that make it to each epidemic size
data %>% group_by(Variance, cov, traits) %>% summarise(size=seq(0,max(data$peakSize)+2), ECDF=sapply(seq(0,max(data$peakSize)+2), function(i) sum(peakSize>=i)/100)) -> data2
# compute the fraction of replicates that make it to each epidemic prevalence
data %>% group_by(Variance, cov, traits) %>% summarise(size=seq(0,max(data$peakPrev)+0.02,0.01), ECDF=sapply(seq(0,max(data$peakPrev)+0.02,0.01), function(i) sum(peakPrev>=i)/100)) -> data3
head(data)
# compute the fraction of replicates that make it to each epidemic size
data %>% group_by(Variance, cov, traits) %>% reframe(size=seq(0,max(data$peakSize)+2), ECDF=sapply(seq(0,max(data$peakSize)+2), function(i) sum(peakSize>=i)/100)) -> data2
# compute the fraction of replicates that make it to each epidemic prevalence
data %>% group_by(Variance, cov, traits) %>% reframe(size=seq(0,max(data$peakPrev)+0.02,0.01), ECDF=sapply(seq(0,max(data$peakPrev)+0.02,0.01), function(i) sum(peakPrev>=i)/100)) -> data3
head(data2)
head(datat3)
head(data3)
ggplot(data2, aes(x=size, y=ECDF, group=Variance, colour=Variance)) +
geom_line(size=0.8) +
facet_grid(cov~traits) +
ylim(0,1.05) +
geom_text(data=subset(data %>% group_by(Variance, cov, traits) %>% summarise(pan=unique(panelLab)),Variance=='high'),
mapping=aes(x=2, y=1.03, label=pan),color='black', size=2.5, hjust=0) +
geom_text(data=subset(data %>%
group_by(Variance, cov, traits) %>%
summarise(fadeoutFrac=sum(fadeout==1)/100) %>%
mutate(lab=paste0("Pr","=",fadeoutFrac)),
Variance=="low"),
mapping=aes(x=120, y=1.03, label=lab, color=Variance), size=2.5, hjust=0) +
geom_text(data=subset(data %>%
group_by(Variance, cov, traits) %>%
summarise(fadeoutFrac=sum(fadeout==1)/100) %>%
mutate(lab=paste0("Pr","=",fadeoutFrac)),
Variance=="med"),
mapping=aes(x=120, y=0.93, label=lab, color=Variance), size=2.5, hjust=0) +
geom_text(data=subset(data %>%
group_by(Variance, cov, traits) %>%
summarise(fadeoutFrac=sum(fadeout==1)/100) %>%
mutate(lab=paste0("Pr","=",fadeoutFrac)),
Variance=="high"),
mapping=aes(x=120, y=0.83, label=lab, color=Variance), size=2.5, hjust=0) +
xlab("Epidemic size") +
ylab(expression("%"~of~simulations~(italic(R)[0]==1))) +
ggtitle("Intergroup trait pairings                                                                                                                             Intragroup trait pairings") +
theme_bw() +
theme(axis.text=element_text(size=6), axis.title=element_text(size=8), legend.text=element_text(size=7), legend.title=element_text(size=8), plot.title = element_text(size=8), strip.text.x = element_text(size = 7), strip.text.y = element_text(size = 7)) +
scale_color_manual(values=c("cornflowerblue", "pink", "sienna")) +
scale_fill_manual(values=c("cornflowerblue", "pink", "sienna"))
ggplot(data2, aes(x=size, y=log(ECDF), group=Variance, colour=Variance)) +
geom_line(size=0.8) +
facet_grid(cov~traits) +
ylim(0,1.05) +
geom_text(data=subset(data %>% group_by(Variance, cov, traits) %>% summarise(pan=unique(panelLab)),Variance=='high'),
mapping=aes(x=2, y=1.03, label=pan),color='black', size=2.5, hjust=0) +
geom_text(data=subset(data %>%
group_by(Variance, cov, traits) %>%
summarise(fadeoutFrac=sum(fadeout==1)/100) %>%
mutate(lab=paste0("Pr","=",fadeoutFrac)),
Variance=="low"),
mapping=aes(x=120, y=1.03, label=lab, color=Variance), size=2.5, hjust=0) +
geom_text(data=subset(data %>%
group_by(Variance, cov, traits) %>%
summarise(fadeoutFrac=sum(fadeout==1)/100) %>%
mutate(lab=paste0("Pr","=",fadeoutFrac)),
Variance=="med"),
mapping=aes(x=120, y=0.93, label=lab, color=Variance), size=2.5, hjust=0) +
geom_text(data=subset(data %>%
group_by(Variance, cov, traits) %>%
summarise(fadeoutFrac=sum(fadeout==1)/100) %>%
mutate(lab=paste0("Pr","=",fadeoutFrac)),
Variance=="high"),
mapping=aes(x=120, y=0.83, label=lab, color=Variance), size=2.5, hjust=0) +
xlab("Epidemic size") +
ylab(expression("%"~of~simulations~(italic(R)[0]==1))) +
ggtitle("Intergroup trait pairings                                                                                                                             Intragroup trait pairings") +
theme_bw() +
theme(axis.text=element_text(size=6), axis.title=element_text(size=8), legend.text=element_text(size=7), legend.title=element_text(size=8), plot.title = element_text(size=8), strip.text.x = element_text(size = 7), strip.text.y = element_text(size = 7)) +
scale_color_manual(values=c("cornflowerblue", "pink", "sienna")) +
scale_fill_manual(values=c("cornflowerblue", "pink", "sienna"))
ggplot(data2, aes(x=log(size), y=log(ECDF), group=Variance, colour=Variance)) +
geom_line(size=0.8) +
facet_grid(cov~traits) +
ylim(0,1.05) +
geom_text(data=subset(data %>% group_by(Variance, cov, traits) %>% summarise(pan=unique(panelLab)),Variance=='high'),
mapping=aes(x=2, y=1.03, label=pan),color='black', size=2.5, hjust=0) +
geom_text(data=subset(data %>%
group_by(Variance, cov, traits) %>%
summarise(fadeoutFrac=sum(fadeout==1)/100) %>%
mutate(lab=paste0("Pr","=",fadeoutFrac)),
Variance=="low"),
mapping=aes(x=120, y=1.03, label=lab, color=Variance), size=2.5, hjust=0) +
geom_text(data=subset(data %>%
group_by(Variance, cov, traits) %>%
summarise(fadeoutFrac=sum(fadeout==1)/100) %>%
mutate(lab=paste0("Pr","=",fadeoutFrac)),
Variance=="med"),
mapping=aes(x=120, y=0.93, label=lab, color=Variance), size=2.5, hjust=0) +
geom_text(data=subset(data %>%
group_by(Variance, cov, traits) %>%
summarise(fadeoutFrac=sum(fadeout==1)/100) %>%
mutate(lab=paste0("Pr","=",fadeoutFrac)),
Variance=="high"),
mapping=aes(x=120, y=0.83, label=lab, color=Variance), size=2.5, hjust=0) +
xlab("Epidemic size") +
ylab(expression("%"~of~simulations~(italic(R)[0]==1))) +
ggtitle("Intergroup trait pairings                                                                                                                             Intragroup trait pairings") +
theme_bw() +
theme(axis.text=element_text(size=6), axis.title=element_text(size=8), legend.text=element_text(size=7), legend.title=element_text(size=8), plot.title = element_text(size=8), strip.text.x = element_text(size = 7), strip.text.y = element_text(size = 7)) +
scale_color_manual(values=c("cornflowerblue", "pink", "sienna")) +
scale_fill_manual(values=c("cornflowerblue", "pink", "sienna"))
ggplot(data2, aes(x=log(size), y=log(ECDF), group=Variance, colour=Variance)) +
geom_line(size=0.8) +
facet_grid(cov~traits) +
ylim(0,1.05)
ggplot(data2, aes(x=ln(size), y=ln(ECDF), group=Variance, colour=Variance)) +
geom_line(size=0.8) +
facet_grid(cov~traits) +
ylim(0,1.05)
ggplot(data2, aes(x=log(size, base=10), y=log(ECDF, base=10), group=Variance, colour=Variance)) +
geom_line(size=0.8) +
facet_grid(cov~traits) +
ylim(0,1.05)
ggplot(data2, aes(x=size, y=ECDF, group=Variance, colour=Variance)) +
geom_line(size=0.8) +
facet_grid(cov~traits) +
ylim(0,1.05) +
geom_text(data=subset(data %>% group_by(Variance, cov, traits) %>% summarise(pan=unique(panelLab)),Variance=='high'),
mapping=aes(x=2, y=1.03, label=pan),color='black', size=2.5, hjust=0) +
geom_text(data=subset(data %>%
group_by(Variance, cov, traits) %>%
summarise(fadeoutFrac=sum(fadeout==1)/100) %>%
mutate(lab=paste0("Pr","=",fadeoutFrac)),
Variance=="low"),
mapping=aes(x=120, y=1.03, label=lab, color=Variance), size=2.5, hjust=0) +
geom_text(data=subset(data %>%
group_by(Variance, cov, traits) %>%
summarise(fadeoutFrac=sum(fadeout==1)/100) %>%
mutate(lab=paste0("Pr","=",fadeoutFrac)),
Variance=="med"),
mapping=aes(x=120, y=0.93, label=lab, color=Variance), size=2.5, hjust=0) +
geom_text(data=subset(data %>%
group_by(Variance, cov, traits) %>%
summarise(fadeoutFrac=sum(fadeout==1)/100) %>%
mutate(lab=paste0("Pr","=",fadeoutFrac)),
Variance=="high"),
mapping=aes(x=120, y=0.83, label=lab, color=Variance), size=2.5, hjust=0) +
xlab("Epidemic size") +
ylab(expression("%"~of~simulations~(italic(R)[0]==1))) +
ggtitle("Intergroup trait pairings                                                                                                                             Intragroup trait pairings") +
theme_bw() +
theme(axis.text=element_text(size=6), axis.title=element_text(size=8), legend.text=element_text(size=7), legend.title=element_text(size=8), plot.title = element_text(size=8), strip.text.x = element_text(size = 7), strip.text.y = element_text(size = 7)) +
scale_color_manual(values=c("cornflowerblue", "pink", "sienna")) +
scale_fill_manual(values=c("cornflowerblue", "pink", "sienna"))
## R0 = 8 plots
var1=c('c',    'c',    'shed', 'shed', 'c',   'alpha')
var2=c('gamma','alpha','gamma','alpha','shed','gamma')
i <- 1
data <- vector(mode='list', length=18)
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
z1 = readRDS(paste0(paste("out_R=8",covMatrix,"hivar",var1[j],var2[j],sep="_"),".RDS"))
z2 = readRDS(paste0(paste("out_R=8",covMatrix,"medvar",var1[j],var2[j],sep="_"),".RDS"))
z3 = readRDS(paste0(paste("out_R=8",covMatrix,"lowvar",var1[j],var2[j],sep="_"),".RDS"))
## Provide a label for each plot panel
panel <- paste0(LETTERS[j],switch(covMatrix,poscorr="(3)",negcorr="(1)",nocorr="(2)"))
## Give nicer names
covMatrix <- switch(covMatrix,poscorr="(+) Cov",negcorr="(-) Cov",nocorr="(0) Cov")
trait1 <- switch(var1[j],c="Contact",shed="Infectiousness",alpha="Virulence")
trait2 <- switch(var2[j],shed="Infectiousness",alpha="Virulence",gamma="Recovery")
z <- vector(mode='list',length=3)
lapply(1:length(z1), function(i) data.frame(peakSize=max(z1[[i]][[1]]$I,na.rm=TRUE), ## peak epidemic size
peakPrev=max(z1[[i]][[1]]$I/(z1[[i]][[1]]$S+z1[[i]][[1]]$I+z1[[i]][[1]]$R),na.rm=TRUE),
disp=ifelse(max(z1[[i]][[1]]$t)>99, glm.nb(z1[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
fadeout=ifelse(length(z1[[i]][[1]]$t)<99, 1, 0), # binary: did this replicate go extinct?
rep=i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="high",cov=covMatrix, traits=paste(trait1,trait2,sep="-"), panelLab=panel) -> z[[1]]
lapply(1:length(z2), function(i) data.frame(peakSize=max(z2[[i]][[1]]$I,na.rm=TRUE), ## peak epidemic size
peakPrev=max(z2[[i]][[1]]$I/(z2[[i]][[1]]$S+z2[[i]][[1]]$I+z2[[i]][[1]]$R),na.rm=TRUE),
disp=ifelse(max(z2[[i]][[1]]$t)>99, glm.nb(z2[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
fadeout=ifelse(length(z2[[i]][[1]]$t)<99, 1, 0),
rep=i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="med",cov=covMatrix, traits=paste(trait1,trait2,sep="-"), panelLab=panel) -> z[[2]]
lapply(1:length(z3), function(i) data.frame(peakSize=max(z3[[i]][[1]]$I,na.rm=TRUE), ## peak epidemic size
peakPrev=max(z3[[i]][[1]]$I/(z3[[i]][[1]]$S+z3[[i]][[1]]$I+z3[[i]][[1]]$R),na.rm=TRUE),
disp=ifelse(max(z3[[i]][[1]]$t)>99, glm.nb(z3[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
fadeout=ifelse(length(z3[[i]][[1]]$t)<99, 1, 0),
rep=i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="low",cov=covMatrix, traits=paste(trait1,trait2,sep="-"), panelLab=panel) -> z[[3]]
data[[i]] <- do.call("rbind.data.frame",z)
i <- i+1
}
}
166*2
