all_PLAND[which(all_PLAND$class==121), 6] = with(all_PLAND, sum(value[class%in%c(121,122,123,124)]))
# combine forest types
all_PLAND[which(all_PLAND$class==141), 6] = with(all_PLAND, sum(value[class%in%c(143,141,142)]))
# combine specialty crops
all_PLAND[which(all_PLAND$class==254), 6] =
with(all_PLAND,sum(value[class%in%c(43,42,53,254,23,44,41,205,21,39,59,12,236,58,240,254,6,237,26,69,51,229,60)]))
# remove collapsed classses
filter(all_PLAND, !class %in%
c(122,123,124,142,143,43,42,53,23,44,41,205,21,39,59,12,236,58,240,6,237,26,69,51,229,60))-> all_PLAND
all_PLAND<- inner_join(all_PLAND, landcover_dat, by="class")
# landscape metrics
# percentage of landscape in each class
all_PLAND<-lsm_c_pland(all_a, direction=8)
all_PLAND<- inner_join(all_PLAND, landcover_dat, by="class")
all_PLAND$CLASS_NAME[all_PLAND$CLASS_NAME=="Developed/Open Space"]<-"Developed"
all_PLAND$CLASS_NAME[all_PLAND$CLASS_NAME=="Deciduous Forest"]<-"Forest"
all_PLAND$CLASS_NAME[all_PLAND$CLASS_NAME=="Dbl Crop Barley/Soybeans"]<-"Specialty/other"
# remove collapsed classses
filter(all_PLAND, !class %in%
c(122,123,124,142,143,43,225,42,53,23,44,41,205,21,39,59,12,236,58,240,6,237,26,69,51,229,60))-> all_PLAND
all_a
# all column to describe space use
all_PLAND %<>% add_column(landscape="all_species")
# landscape metrics
# percentage of landscape in each class
all_PLAND<-lsm_c_pland(all_a, direction=8)
# combine development types
all_PLAND[which(all_PLAND$class==121), 6] = with(all_PLAND, sum(value[class%in%c(121,122,123,124)]))
# combine forest types
all_PLAND[which(all_PLAND$class==141), 6] = with(all_PLAND, sum(value[class%in%c(143,141,142)]))
# combine specialty crops
all_PLAND[which(all_PLAND$class==254), 6] =
with(all_PLAND,sum(value[class%in%c(43,42,53,254,225,23,44,41,205,21,39,59,12,236,58,240,254,6,237,26,69,51,229,60)]))
# combine wetlands
all_PLAND[which(all_PLAND$class==190), 6] =
with(all_PLAND,sum(value[class%in%c(190,195)]))
# remove collapsed classses
filter(all_PLAND, !class %in%
c(122,123,124,142,143,195,43,225,42,53,23,44,41,205,21,39,59,12,236,58,240,6,237,26,69,51,229,60))-> all_PLAND
all_PLAND<- inner_join(all_PLAND, landcover_dat, by="class")
all_PLAND$CLASS_NAME[all_PLAND$CLASS_NAME=="Developed/Open Space"]<-"Developed"
all_PLAND$CLASS_NAME[all_PLAND$CLASS_NAME=="Deciduous Forest"]<-"Forest"
all_PLAND$CLASS_NAME[all_PLAND$CLASS_NAME=="Dbl Crop Barley/Soybeans"]<-"Specialty/other"
all_PLAND$CLASS_NAME[all_PLAND$CLASS_NAME=="Woody Wetlands"]<-"Wetlands"
ggplot(all_PLAND, aes(x=as.factor(class), y=value))+
geom_col()+
theme_bw()
ggplot(all_PLAND, aes(x=as.factor(CLASS_NAME), y=value))+
geom_col()+
theme_bw()
# analysis for project
MD<-rast("landcover_min_bound_geo_2KMbuffer_min_bound_geo_all_MD.tif")
WT<-rast("landcover_min_bound_geo_2KMbuffer_min_bound_geo_all_WT.tif")
pos_intx<-rast("landcover_min_bound_geo_2KMbuffer_pos_intersect.tif")
# data on the class and cover type
landcover_dat<-read.csv("landcover_data.csv")
all_MD<-classify(x = all_MD, rcl = cbind(NA, NA))
all_WT<-classify(x = all_WT, rcl = cbind(NA, NA))
pos_intx<-classify(x = pos_intx, rcl = cbind(NA, NA))
# landscape metrics
# percentage of landscape in each class
md_pladj<-lsm_c_pladj(all_MD,direction=8)
# landscape metrics
# percentage of landscape in each class
md_pladj<-lsm_c_pladj(all_MD)
View(md_pladj)
# combine development types
md_pladj[which(md_pladj$class==121), 6] = with(md_pladj, sum(value[class%in%c(121,122,123,124)]))
# combine forest types
md_pladj[which(md_pladj$class==141), 6] = with(md_pladj, sum(value[class%in%c(143,141,142)]))
# combine specialty crops
md_pladj[which(md_pladj$class==254), 6] =
with(md_pladj,sum(value[class%in%c(43,42,53,254,225,23,44,41,205,21,39,59,12,236,58,240,254,6,237,26,69,51,229,60)]))
# combine wetlands
md_pladj[which(md_pladj$class==190), 6] =
with(md_pladj,sum(value[class%in%c(190,195)]))
# remove collapsed classses
filter(md_pladj, !class %in%
c(122,123,124,142,143,195,43,225,42,53,23,44,41,205,21,39,59,12,236,58,240,6,237,26,69,51,229,60))-> all_PLAND
# remove collapsed classses
filter(md_pladj, !class %in%
c(122,123,124,142,143,195,43,225,42,53,23,44,41,205,21,39,59,12,236,58,240,6,237,26,69,51,229,60))-> md_pladj
# add class names to df
md_pladj<- inner_join(md_pladj, landcover_dat, by="class")
View(landcover_dat)
landcover_dat<-rename(landcover_dat, class=VALUE)
# add class names to df
md_pladj<- inner_join(md_pladj, landcover_dat, by="class")
md_pladj$CLASS_NAME[md_pladj$CLASS_NAME=="Developed/Open Space"]<-"Developed"
md_pladj$CLASS_NAME[md_pladj$CLASS_NAME=="Deciduous Forest"]<-"Forest"
md_pladj$CLASS_NAME[md_pladj$CLASS_NAME=="Dbl Crop Barley/Soybeans"]<-"Specialty/other"
md_pladj$CLASS_NAME[md_pladj$CLASS_NAME=="Woody Wetlands"]<-"Wetlands"
md_pladj %<>% add_column(landscape="Mule Deer")
# WHITE TAIL DEER
wt_pladj<-lsm_c_pladj(all_WT)
# combine development types
wt_pladj[which(wt_pladj$class==121), 6] = with(wt_pladj, sum(value[class%in%c(121,122,123,124)]))
# combine forest types
wt_pladj[which(wt_pladj$class==141), 6] = with(wt_pladj, sum(value[class%in%c(143,141,142)]))
# combine specialty crops
wt_pladj[which(wt_pladj$class==254), 6] =
with(wt_pladj,sum(value[class%in%c(43,42,53,254,225,23,44,41,205,21,39,59,12,236,58,240,254,6,237,26,69,51,229,60)]))
# combine wetlands
wt_pladj[which(wt_pladj$class==190), 6] =
with(wt_pladj,sum(value[class%in%c(190,195)]))
# add class names to df
wt_pladj<- inner_join(wt_pladj, landcover_dat, by="class")
wt_pladj$CLASS_NAME[wt_pladj$CLASS_NAME=="Developed/Open Space"]<-"Developed"
wt_pladj$CLASS_NAME[wt_pladj$CLASS_NAME=="Deciduous Forest"]<-"Forest"
wt_pladj$CLASS_NAME[wt_pladj$CLASS_NAME=="Dbl Crop Barley/Soybeans"]<-"Specialty/other"
wt_pladj$CLASS_NAME[wt_pladj$CLASS_NAME=="Woody Wetlands"]<-"Wetlands"
wt_pladj %<>% add_column(landscape="White Tail Deer")
# INTX ZONE
intx_pladj<-lsm_c_pladj(pos_intx)
# combine development types
intx_pladj[which(intx_pladj$class==121), 6] = with(intx_pladj, sum(value[class%in%c(121,122,123,124)]))
# combine forest types
intx_pladj[which(intx_pladj$class==141), 6] = with(intx_pladj, sum(value[class%in%c(143,141,142)]))
# combine specialty crops
intx_pladj[which(intx_pladj$class==254), 6] =
with(intx_pladj,sum(value[class%in%c(43,42,53,254,225,23,44,41,205,21,39,59,12,236,58,240,254,6,237,26,69,51,229,60)]))
# combine wetlands
intx_pladj[which(intx_pladj$class==190), 6] =
with(intx_pladj,sum(value[class%in%c(190,195)]))
# remove collapsed classses
filter(intx_pladj, !class %in%
c(122,123,124,142,143,195,43,225,42,53,23,44,41,205,21,39,59,12,236,58,240,6,237,26,69,51,229,60))-> intx_pladj
# add class names to df
intx_pladj<- inner_join(intx_pladj, landcover_dat, by="class")
intx_pladj$CLASS_NAME[intx_pladj$CLASS_NAME=="Developed/Open Space"]<-"Developed"
intx_pladj$CLASS_NAME[intx_pladj$CLASS_NAME=="Deciduous Forest"]<-"Forest"
intx_pladj$CLASS_NAME[intx_pladj$CLASS_NAME=="Dbl Crop Barley/Soybeans"]<-"Specialty/other"
intx_pladj$CLASS_NAME[intx_pladj$CLASS_NAME=="Woody Wetlands"]<-"Wetlands"
intx_pladj %<>% add_column(landscape="Interaction Zone")
rbind(md_pladj, wt_pladj, intx_pladj) -> all_pladj
View(md_pladj)
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
geom_col()+
theme_bw()
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
geom_col()+
theme_bw()+
labs(y="% like adjacencies", x="landcover type")
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
geom_col()+
theme_bw()+
labs(y="% like adjacencies", x="landcover type")+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col()+
theme_bw()+
labs(y="% like adjacencies", x="landcover type")+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value), fill=landscape)+
facet_grid(~landscape)+
geom_col()+
theme_bw()+
labs(y="% like adjacencies", x="landcover type")+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(fill=landscape)+
theme_bw()+
labs(y="% like adjacencies", x="landcover type")+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col()+
theme_bw()+
labs(y="% like adjacencies", x="landcover type")+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value, fill=CLASS_NAME))+
facet_grid(~landscape)+
geom_col()+
theme_bw()+
labs(y="% like adjacencies", x="landcover type")+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value),fill=CLASS_NAME)+
facet_grid(~landscape)+
geom_col()+
theme_bw()+
labs(y="% like adjacencies", x="landcover type")+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), fill=CLASS_NAME, aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col()+
theme_bw()+
labs(y="% like adjacencies", x="landcover type")+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(aes(fill=CLASS_NAME))+
theme_bw()+
labs(y="% like adjacencies", x="landcover type")+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")
theme_bw()+
labs(y="% like adjacencies", x="landcover type")+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")
theme_bw()+
labs(y="% like adjacencies", x="landcover type")+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(aes(fill=CLASS_NAME),show.legend = FALSE)+
theme_bw()+
labs(y="% like adjacencies", x="landcover type")+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(aes(fill=CLASS_NAME),show.legend = FALSE)+
theme_bw(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))+
labs(y="% like adjacencies", x="landcover type")+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(aes(fill=CLASS_NAME),show.legend = FALSE)+
theme_bw()+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 10))
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 10))
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(aes(fill=CLASS_NAME),show.legend = FALSE)+
theme_bw()+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")+
labs(y="% like adjacencies", x="landcover type")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 10))
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(aes(fill=CLASS_NAME),show.legend = FALSE)+
theme_bw()+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")+
labs(y="% like adjacencies", x="landcover type")+
theme(text = element_text(size=10),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 20,  # Bottom margin
l = 10))
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(aes(fill=CLASS_NAME),show.legend = FALSE)+
theme_bw()+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")+
labs(y="% like adjacencies", x="landcover type")+
theme(text = element_text(size=11),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 10))
theme(text = element_text(size=11),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 10))
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(aes(fill=CLASS_NAME),show.legend = FALSE)+
theme_bw()+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")+
labs(y="% like adjacencies", x="landcover type")+
scale_x_discrete(guide = guide_axis(n.dodge=2))+
theme(text = element_text(size=11),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 10))
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(aes(fill=CLASS_NAME),show.legend = FALSE)+
theme_bw()+
geom_text(aes(label = round(value, 3)), size=2.5, vjust = 2.5, col="white")+
labs(y="% like adjacencies", x="landcover type")+
scale_x_discrete(guide = guide_axis(n.dodge=2))+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 10))
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(aes(fill=CLASS_NAME),show.legend = FALSE)+
theme_bw()+
geom_text(aes(label = round(value, 3)), size=5, vjust = 2.5, col="white")+
labs(y="% like adjacencies", x="landcover type")+
scale_x_discrete(guide = guide_axis(n.dodge=2))+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 10))
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(aes(fill=CLASS_NAME),show.legend = FALSE)+
theme_bw()+
geom_text(aes(label = round(value, 2)), size=5, vjust = 2.5, col="white")+
labs(y="% like adjacencies", x="landcover type")+
scale_x_discrete(guide = guide_axis(n.dodge=2))+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 10))
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(aes(fill=CLASS_NAME),show.legend = FALSE)+
theme_bw()+
geom_text(aes(label = round(value, 1.75)), size=5, vjust = 2.5, col="white")+
labs(y="% like adjacencies", x="landcover type")+
scale_x_discrete(guide = guide_axis(n.dodge=2))+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 10))
all_pladj$landscape[all_pladj$landscape=="Interaction Zone"]<-"(+) Interaction Zone"
ggplot(subset(all_pladj, CLASS_NAME %in% c("Corn","Grassland/Pasture","Soybeans","Wetlands","Developed",
"Alfalfa","Forest")), aes(x=as.factor(CLASS_NAME), y=value))+
facet_grid(~landscape)+
geom_col(aes(fill=CLASS_NAME),show.legend = FALSE)+
theme_bw()+
geom_text(aes(label = round(value, 1.75)), size=5, vjust = 2.5, col="white")+
labs(y="% like adjacencies", x="landcover type")+
scale_x_discrete(guide = guide_axis(n.dodge=2))+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 10))
setwd("/Users/alexisbeagle/newGEM_SIR/Trait_covariance_simulations_and_data_analysis")
# r04, nocorr, medvar, contact/shed
dat<-readRDS("out_R=4_nocorr_medvar_c_shed.RDS")
head(dat)
dat[[1]]
length(dat)
dim(dat[[1]])
dim(dat)
?dim
nrow(dat)
length(dat[[1]])
length(dat[[1]][1])
dat[[1]][1]
length(dat)
## plot I over time for 20 simulations
test_storage <- array(NA, dim=c(20,length(dat)))
test_storage
dat[[1]]
dat[[1]][,3]
j=1
o <- dat[[j]]
test_storage[,j] <- o[,3]
dat[[i]][[1]]$I
dat[[1]][[1]]$I
sub_dat<-dat[[1:20]]
dat[[1:20]]
plot(dat[[1]][[1]]$I)
plot(dat[[1]][[1]]$I, type=l)
plot(dat[[1]][[1]]$I, type="l")
plot(0:100, apply(dat, 1, mean))
?subset
length(dat[[1]][[1]]$I)
length(dat[[2]][[1]]$I)
# plot 20 sims of I over time
store<-array(NA, dim=c(20,length(dat[[1]][[1]]$I))
# plot 20 sims of I over time
store<-array(NA, dim=c(20,length(dat[[1]][[1]]$I)))
store
for (i in 1:20) {
store[[i]]<-dat[[i]][[1]]$I
}
store[[1]]
# plot 20 sims of I over time
test_I<-lapply(1:20, function(i) data,frame(I = dat[[i]][[1]]$I))
# plot 20 sims of I over time
test_I<-lapply(1:20, function(i) data.frame(numI = dat[[i]][[1]]$I))
head(test_I)
plot(0:100, test_I, type="l")
dat[[i]][[1]]
?round
# plot 20 sims of I over time
subset_dat<-lapply(1:20, function(i) data.frame(numI = dat[[i]][[1]]$I,
time=round(dat[[i]][[1]]$t)))
ggplot(subset_dat, aes(x=time, y=numI))+
geom_line()
# plot 20 sims of I over time
subset_dat<-lapply(1:20, function(i) data.frame(numI = dat[[i]][[1]]$I,
time=round(dat[[i]][[1]]$t))) %>% unlist()
ggplot(subset_dat, aes(x=time, y=numI))+
geom_line()
class(subset_dat)
# plot 20 sims of I over time
subset_dat<-lapply(1:20, function(i) data.frame(numI = dat[[i]][[1]]$I,
time=round(dat[[i]][[1]]$t))) %>% do.call("rbind.data.frame",.)
class(subset_dat)
ggplot(subset_dat, aes(x=time, y=numI))+
geom_line()
head(subset_dat)
subset_dat
# plot 20 sims of I over time
subset_dat<-lapply(1:20, function(i) data.frame(numI = dat[[i]][[1]]$I,
time=round(dat[[i]][[1]]$t),
rep=i)) %>% do.call("rbind.data.frame",.)
head(subset_daat)
head(subset_dat)
ggplot(subset_dat, aes(x=time, y=numI, color=rep))+
geom_line()
subset_dat
subset_dat<-lapply(1:20, function(i) data.frame(numI = dat[[i]][[1]]$I,
time=round(dat[[i]][[1]]$t),
rep=i))
lapply(subset_dat, function(x) ggplot(x,aes(x=time,y=numI))+
geom_line())
library(purrr)
library(dplyr)
library(ggplot2)
install.packages("purrr")
library(purrr)
map(subset_dat, ~ .x %>%
ggplot(aes(x = time, y = numI)) +
geom_line())
plot(0:100, apply(subset_dat, 1, mean), col="red", lwd=1.75, type="l", ylim=c(0,150), ylab="N", xlab="Time", main="Alpha - Infected")
head(subset_dat)
lapply(subset_dat, function(x) ggplot(x,aes(x=time,y=numI, color=rep))+
geom_line())
graph <- ggplot(bind_rows(subset_dat, .id="data_frame"),
aes(time, numI, colour=data_frame))+
geom_line()
print(graph)
ggplot(bind_rows(subset_dat, .id="data_frame"),
aes(time, numI))+
geom_line()
ggplot(bind_rows(subset_dat, .id="rep"),
aes(time, numI, color=rep))+
geom_line()
ggplot(bind_rows(subset_dat, .id="rep"),
aes(time, numI), color=rep)+
geom_line()
ggplot(bind_rows(subset_dat, .id="rep"),
aes(time, numI, color=rep))+
geom_line()+
theme(legend.position = "none")+
theme_bw()
ggplot(bind_rows(subset_dat, .id="rep"),
aes(time, numI, color=rep))+
geom_line(show.legend = FALSE)+
theme_bw()
ggplot(bind_rows(subset_dat, .id="rep"),
aes(time, numI, color=rep))+
geom_line(show.legend = FALSE)+
theme_bw()+
labs(y="Number Infected", x= "Time")
setwd("/Users/alexisbeagle/newGEM_SIR/Trait_covariance_simulations_and_data_analysis")
dd = readRDS("out_R0=8_CV=0.2_corr=0.3_cov=c-s.RDS")
dd
hist(dd$peak)
hist(dd$disp)
dd1 = readRDS("out_R0=8_CV=1_corr=-0.9_cov=c-s.RDS")
dd2 = readRDS("out_R0=8_CV=1_corr=0.9_cov=c-s.RDS")
dd1 = readRDS("out_R0=8_CV=1_corr=-0.8_cov=c-s.RDS")
dd1 = readRDS("out_R0=8_CV=1_corr=-0.7_cov=c-s.RDS")
dd1 = readRDS("out_R0=8_CV=1_corr=-0.6_cov=c-s.RDS")
dd2 = readRDS("out_R0=8_CV=1_corr=0.9_cov=c-s.RDS")
t.test(dd1$peak, dd2$peak)
mean(dd1$peak)
mean(dd2$peak)
