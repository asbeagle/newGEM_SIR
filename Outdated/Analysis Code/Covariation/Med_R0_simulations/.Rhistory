intragroup<-ggplot(subset(data, traits%in%c("alpha-gamma", "c-shed")), aes(x=t, y=I, group=rep)) +
stat_summary(aes(group=Variance), geom="ribbon", fun.data=mean_cl_normal, alpha=.45, fun.args=list(conf.int=0.95)) +
stat_summary(aes(group=Variance,colour=Variance), geom="line", fun=mean) +
facet_grid(traits~cov) +
ylim(0,225) +
xlim(0,50)+
scale_color_manual(values=c("cornflowerblue", "tan4", "sienna3"))+
labs(x = "", y = "I")+
theme_bw()+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 40,  # Top margin
r = 20,  # Right margin
b = -10,  # Bottom margin
l = 40))+
ggtitle("Intragroup Trait Pairings")
intragroup
intragroup<-ggplot(subset(data, traits%in%c("alpha-gamma", "c-shed")), aes(x=t, y=I, group=rep)) +
stat_summary(aes(group=Variance), geom="ribbon", fun.data=mean_cl_normal, alpha=.45, fun.args=list(conf.int=0.95)) +
stat_summary(aes(group=Variance,colour=Variance), geom="line", fun=mean) +
facet_grid(traits~cov) +
ylim(0,225) +
xlim(0,50)+
scale_color_manual(values=c("cornflowerblue", "lavender", "sienna3"))+
labs(x = "", y = "I")+
theme_bw()+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 40,  # Top margin
r = 20,  # Right margin
b = -10,  # Bottom margin
l = 40))+
ggtitle("Intragroup Trait Pairings")
intragroup
intragroup<-ggplot(subset(data, traits%in%c("alpha-gamma", "c-shed")), aes(x=t, y=I, group=rep)) +
stat_summary(aes(group=Variance), geom="ribbon", fun.data=mean_cl_normal, alpha=.45, fun.args=list(conf.int=0.95)) +
stat_summary(aes(group=Variance,colour=Variance), geom="line", fun=mean) +
facet_grid(traits~cov) +
ylim(0,225) +
xlim(0,50)+
scale_color_manual(values=c("cornflowerblue", "lavender", "sienna3"))+
labs(x = "", y = "I")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 40,  # Top margin
r = 20,  # Right margin
b = -10,  # Bottom margin
l = 40))+
ggtitle("Intragroup Trait Pairings")
intragroup
intragroup<-ggplot(subset(data, traits%in%c("alpha-gamma", "c-shed")), aes(x=t, y=I, group=rep)) +
stat_summary(aes(group=Variance), geom="ribbon", fun.data=mean_cl_normal, alpha=.45, fun.args=list(conf.int=0.95)) +
stat_summary(aes(group=Variance,colour=Variance), geom="line", fun=mean) +
facet_grid(traits~cov) +
ylim(0,225) +
xlim(0,50)+
scale_color_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
labs(x = "", y = "I")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 40,  # Top margin
r = 20,  # Right margin
b = -10,  # Bottom margin
l = 40))+
ggtitle("Intragroup Trait Pairings")
intragroup
intragroup<-ggplot(subset(data, traits%in%c("alpha-gamma", "c-shed")), aes(x=t, y=I, group=rep)) +
stat_summary(aes(group=Variance), geom="ribbon", fun.data=mean_cl_normal, alpha=.45, fun.args=list(conf.int=0.95)) +
stat_summary(aes(group=Variance,colour=Variance), geom="line", fun=mean) +
facet_grid(traits~cov) +
ylim(0,225) +
xlim(0,50)+
scale_color_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
labs(x = "", y = "I")+
theme_bw()+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 40,  # Top margin
r = 20,  # Right margin
b = -10,  # Bottom margin
l = 40))+
ggtitle("Intragroup Trait Pairings")
intragroup
intragroup<-ggplot(subset(data, traits%in%c("alpha-gamma", "c-shed")), aes(x=t, y=I, group=rep)) +
stat_summary(aes(group=Variance), geom="ribbon", fun.data=mean_cl_normal, alpha=.45, fun.args=list(conf.int=0.95)) +
stat_summary(aes(group=Variance,colour=Variance), geom="line", fun=mean) +
facet_grid(traits~cov) +
ylim(0,225) +
xlim(0,50)+
scale_color_manual(values=c("cornflowerblue", "pink", "sienna3"))+
labs(x = "", y = "I")+
theme_bw()+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 40,  # Top margin
r = 20,  # Right margin
b = -10,  # Bottom margin
l = 40))+
ggtitle("Intragroup Trait Pairings")
intragroup
## To plot the dynamics of S across all trait pairs, covariance structures, and variance levels
intergroup<-ggplot(subset(data, traits%in%c("shed-alpha","shed-gamma")), aes(x=t, y=I, group=rep)) +
stat_summary(aes(group=Variance), geom="ribbon", fun.data=mean_cl_normal, alpha=.45, fun.args=list(conf.int=0.95)) +
stat_summary(aes(group=Variance,colour=Variance), geom="line", fun=mean) +
facet_grid(traits~cov) +
ylim(0,225) +
xlim(0,50)+
scale_color_manual(values=c("cornflowerblue", "pink", "sienna3"))+
labs(x = "Time", y = "I")+
theme_bw()+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
ggtitle("Intergroup Trait Pairings")
intergroup
intragroup<-ggplot(subset(data, traits%in%c("alpha-gamma", "c-shed")), aes(x=t, y=I, group=rep)) +
stat_summary(aes(group=Variance), geom="ribbon", fun.data=mean_cl_normal, alpha=.45, fun.args=list(conf.int=0.95)) +
stat_summary(aes(group=Variance,colour=Variance), geom="line", fun=mean) +
facet_grid(traits~cov) +
ylim(0,225) +
xlim(0,50)+
scale_color_manual(values=c("cornflowerblue", "pink", "sienna3"))+
labs(x = "Time", y = "I")+
theme_bw()+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 40,  # Top margin
r = 20,  # Right margin
b = -10,  # Bottom margin
l = 40))+
ggtitle("Intragroup Trait Pairings")
intragroup
intragroup<-ggplot(subset(data, traits%in%c("alpha-gamma", "c-shed")), aes(x=t, y=I, group=rep)) +
stat_summary(aes(group=Variance), geom="ribbon", fun.data=mean_cl_normal, alpha=.45, fun.args=list(conf.int=0.95)) +
stat_summary(aes(group=Variance,colour=Variance), geom="line", fun=mean) +
facet_grid(traits~cov) +
ylim(0,225) +
xlim(0,50)+
scale_color_manual(values=c("cornflowerblue", "pink", "sienna3"))+
labs(x = "Time", y = "I")+
theme_bw()+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
ggtitle("Intragroup Trait Pairings")
intragroup
## To plot the dynamics of S across all trait pairs, covariance structures, and variance levels
intergroup<-ggplot(subset(data, traits%in%c("shed-alpha","shed-gamma")), aes(x=t, y=I, group=rep)) +
stat_summary(aes(group=Variance), geom="ribbon", fun.data=mean_cl_normal, alpha=.45, fun.args=list(conf.int=0.95)) +
stat_summary(aes(group=Variance,colour=Variance), geom="line", fun=mean) +
facet_grid(traits~cov) +
ylim(0,225) +
xlim(0,50)+
scale_color_manual(values=c("cornflowerblue", "pink", "sienna3"))+
labs(x = "Time", y = "I")+
theme_bw()+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))+
ggtitle("Intergroup Trait Pairings")
intergroup
## Stats on super spreading (k) and peak epidemic size
var1=c('c','c','c','shed','shed','alpha')
var2=c('shed','alpha','gamma','alpha','gamma','gamma')
i <- 1
data <- vector(mode='list', length=18)
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
z1 = readRDS(paste0(paste("out",covMatrix,"hivar",var1[j],var2[j],sep="_"),".RDS"))
z2 = readRDS(paste0(paste("out",covMatrix,"medvar",var1[j],var2[j],sep="_"),".RDS"))
z3 = readRDS(paste0(paste("out",covMatrix,"lowvar",var1[j],var2[j],sep="_"),".RDS"))
z <- vector(mode='list',length=3)
lapply(1:length(z1), function(i) c(max(z1[[i]][[1]]$I), ## peak epidemic size
sum(sort(z1[[i]][[2]]$numInf,decreasing=TRUE)[1:round(0.2*nrow(z1[[i]][[2]]))])/sum(z1[[i]][[2]]$numInf), ## fraction of cases caused by top 20% of spreaders
ifelse(max(z1[[i]][[1]]$t)>99, glm.nb(z1[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="high",cov=covMatrix, traits=paste(var1[j],var2[j],sep="-")) -> z[[1]]
colnames(z[[1]])[1:4] <- c("peak","top20SS","disp","rep")
lapply(1:length(z2), function(i) c(max(z2[[i]][[1]]$I), ## peak epidemic size
sum(sort(z2[[i]][[2]]$numInf,decreasing=TRUE)[1:round(0.2*nrow(z2[[i]][[2]]))])/sum(z2[[i]][[2]]$numInf), ## fraction of cases caused by top 20% of spreaders
ifelse(max(z2[[i]][[1]]$t)>99, glm.nb(z2[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="med",cov=covMatrix, traits=paste(var1[j],var2[j],sep="-")) -> z[[2]]
colnames(z[[2]])[1:4] <- c("peak","top20SS","disp","rep")
lapply(1:length(z3), function(i) c(max(z3[[i]][[1]]$I), ## peak epidemic size
sum(sort(z3[[i]][[2]]$numInf,decreasing=TRUE)[1:round(0.2*nrow(z3[[i]][[2]]))])/sum(z3[[i]][[2]]$numInf), ## fraction of cases caused by top 20% of spreaders
ifelse(max(z3[[i]][[1]]$t)>99, glm.nb(z3[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="low",cov=covMatrix, traits=paste(var1[j],var2[j],sep="-")) -> z[[3]]
colnames(z[[3]])[1:4] <- c("peak","top20SS","disp","rep")
data[[i]] <- do.call("rbind.data.frame",z)
i <- i+1
}
}
data %>% do.call("rbind.data.frame",.) -> data
# order categories
data$Variance<-factor(data$Variance, levels = c("low", "med", "high"))
data$traits<-factor(data$traits, levels=c("alpha-gamma", "c-shed", "c-alpha","c-gamma", "shed-alpha", "shed-gamma"))
# super spreading via dispersion plots, some pairs
ggplot(subset(data, traits%in%c("alpha-gamma","c-shed", "shed-alpha", "shed-gamma")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=1)+
facet_grid(cov~traits)+
theme_bw()+
scale_color_manual(values=c("cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c("cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (K)")
# super spreading via dispersion plots, some pairs
ggplot(subset(data, traits%in%c("alpha-gamma","c-shed", "c-gamma", "shed-gamma")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=1)+
facet_grid(cov~traits)+
theme_bw()+
scale_color_manual(values=c("cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c("cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (K)")
####### PEAK EPIDEMIC SIZE PLOTS
data<-subset(data, peak>5) # remove peaks smaller than 5
# intergroup trait pairings
ggplot(subset(data, traits%in%c("c-gamma", "shed-gamma")), aes(x=Variance, y=peak,shape=cov,fill=cov))+
geom_violin()  +
facet_grid(~traits)+
theme_bw()+
scale_fill_manual(values=c("cornflowerblue", "pink", "sienna3"))
# intragroup trait pairings
ggplot(subset(data, traits%in%c("c-shed", "alpha-gamma")), aes(x=Variance, y=peak,shape=cov,fill=cov))+
geom_violin()  +
facet_grid(~traits)+
theme_bw()+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))
# intergroup trait pairings
ggplot(subset(data, traits%in%c("c-gamma", "shed-gamma")), aes(x=Variance, y=peak,shape=cov,fill=cov))+
geom_violin()  +
facet_grid(~traits)+
theme_bw()+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))
# intergroup trait pairings
ggplot(subset(data, traits%in%c("c-gamma", "shed-gamma")), aes(x=Variance, y=peak,shape=cov,fill=cov))+
geom_violin()  +
facet_grid(~traits)+
theme_bw()+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
ggtitle("Intergroup Trait Pairings")
# intergroup trait pairings
ggplot(subset(data, traits%in%c("c-gamma", "shed-gamma")), aes(x=Variance, y=peak,shape=cov,fill=cov))+
geom_violin()  +
facet_grid(~traits)+
theme_bw()+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
# intragroup trait pairings
ggplot(subset(data, traits%in%c("c-shed", "alpha-gamma")), aes(x=Variance, y=peak,shape=cov,fill=cov))+
geom_violin()  +
facet_grid(~traits)+
theme_bw()+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
ggtitle("Intragroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
# intergroup trait pairings
ggplot(subset(data, traits%in%c("c-gamma", "shed-gamma")), aes(x=Variance, y=peak,shape=cov,fill=cov))+
geom_violin()  +
facet_grid(~traits)+
theme_bw()+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
####### PEAK EPIDEMIC SIZE PLOTS
data<-subset(data, peak>5) # remove peaks smaller than 5
# intragroup trait pairings
ggplot(subset(data, traits%in%c("c-shed", "alpha-gamma")), aes(x=Variance, y=peak,shape=cov,fill=cov))+
geom_violin()  +
facet_grid(~traits)+
theme_bw()+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
ggtitle("Intragroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
# super spreading via dispersion plots, some pairs
ggplot(subset(data, traits%in%c("alpha-gamma","c-shed", "c-gamma", "shed-gamma")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=1)+
facet_grid(cov~traits)+
theme_bw()+
scale_color_manual(values=c("cornflowerblue", "pink", "sienna3"))+
scale_fill_manual(values=c("cornflowerblue", "pink", "sienna3"))+
labs(y="Density", x="Dispersion (K)")
# super spreading via dispersion plots, some pairs
ggplot(subset(data, traits%in%c("alpha-gamma","c-shed", "c-gamma", "shed-gamma")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=1)+
facet_grid(cov~traits)+
theme_bw()+
scale_color_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
labs(y="Density", x="Dispersion (K)")
# super spreading via dispersion plots, some pairs
ggplot(subset(data, traits%in%c("alpha-gamma","c-shed", "c-gamma", "shed-gamma")), aes(x=disp))+
geom_density(aes(group=Variance,color=Variance,fill=Variance),lwd=.5, alpha=1)+
facet_grid(cov~traits)+
theme_bw()+
scale_color_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
labs(y="Density", x="Dispersion (K)")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
###### EFFECT OF SUPER SPREADING ON PEAK EPIDEMIC SIZE
ggplot(subset(data, traits%in%c("alpha-gamma","c-shed", "shed-alpha", "shed-gamma")), aes(x=disp, y=peak, shape=Variance, color=cov))+
geom_point()+
facet_grid(~traits)+
theme_bw()+
scale_color_manual(values=c("pink", "darkblue", "darkgreen"))
###### EFFECT OF SUPER SPREADING ON PEAK EPIDEMIC SIZE
ggplot(subset(data, traits%in%c("alpha-gamma","c-shed", "shed-alpha", "shed-gamma")), aes(x=disp, y=peak, shape=Variance, color=cov))+
geom_point()+
facet_grid(~traits)+
theme_bw()+
scale_color_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))
###### EFFECT OF SUPER SPREADING ON PEAK EPIDEMIC SIZE
ggplot(subset(data, traits%in%c("alpha-gamma","c-shed", "shed-alpha", "shed-gamma")), aes(x=disp, y=peak, shape=Variance, color=cov))+
geom_point()+
facet_grid(~traits)+
theme_bw()+
scale_color_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
###### EFFECT OF SUPER SPREADING ON PEAK EPIDEMIC SIZE
data<-subset(data, peak>50)
ggplot(subset(data, traits%in%c("alpha-gamma","c-shed", "shed-alpha", "shed-gamma")), aes(x=disp, y=peak, shape=Variance, color=cov))+
geom_point()+
facet_grid(~traits)+
theme_bw()+
scale_color_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
ggplot(subset(data, traits%in%c("alpha-gamma","c-shed", "shed-alpha", "shed-gamma")), aes(x=disp, y=peak, shape=Variance, color=cov))+
geom_point()+
facet_grid(~traits)+
theme_bw()+
labs(y="Peak", x="Dispersion (K)")+
scale_color_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
# intergroup trait pairings
ggplot(subset(data, traits%in%c("c-gamma", "shed-gamma")), aes(x=Variance, y=peak,shape=cov,fill=cov))+
geom_violin()  +
facet_grid(~traits)+
theme_bw()+
labs(y="Peak", x="Variance")+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
####### PEAK EPIDEMIC SIZE PLOTS
data<-subset(data, peak>5) # remove peaks smaller than 5
# intergroup trait pairings
ggplot(subset(data, traits%in%c("c-gamma", "shed-gamma")), aes(x=Variance, y=peak,shape=cov,fill=cov))+
geom_violin()  +
facet_grid(~traits)+
theme_bw()+
labs(y="Peak", x="Variance")+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
## Stats on super spreading (k) and peak epidemic size
var1=c('c','c','c','shed','shed','alpha')
var2=c('shed','alpha','gamma','alpha','gamma','gamma')
i <- 1
data <- vector(mode='list', length=18)
for (j in 1:6) { ## loop over the six different covariance combinations
for (covMatrix in c("nocorr", "negcorr", "poscorr")) {
z1 = readRDS(paste0(paste("out",covMatrix,"hivar",var1[j],var2[j],sep="_"),".RDS"))
z2 = readRDS(paste0(paste("out",covMatrix,"medvar",var1[j],var2[j],sep="_"),".RDS"))
z3 = readRDS(paste0(paste("out",covMatrix,"lowvar",var1[j],var2[j],sep="_"),".RDS"))
z <- vector(mode='list',length=3)
lapply(1:length(z1), function(i) c(max(z1[[i]][[1]]$I), ## peak epidemic size
sum(sort(z1[[i]][[2]]$numInf,decreasing=TRUE)[1:round(0.2*nrow(z1[[i]][[2]]))])/sum(z1[[i]][[2]]$numInf), ## fraction of cases caused by top 20% of spreaders
ifelse(max(z1[[i]][[1]]$t)>99, glm.nb(z1[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="high",cov=covMatrix, traits=paste(var1[j],var2[j],sep="-")) -> z[[1]]
colnames(z[[1]])[1:4] <- c("peak","top20SS","disp","rep")
lapply(1:length(z2), function(i) c(max(z2[[i]][[1]]$I), ## peak epidemic size
sum(sort(z2[[i]][[2]]$numInf,decreasing=TRUE)[1:round(0.2*nrow(z2[[i]][[2]]))])/sum(z2[[i]][[2]]$numInf), ## fraction of cases caused by top 20% of spreaders
ifelse(max(z2[[i]][[1]]$t)>99, glm.nb(z2[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="med",cov=covMatrix, traits=paste(var1[j],var2[j],sep="-")) -> z[[2]]
colnames(z[[2]])[1:4] <- c("peak","top20SS","disp","rep")
lapply(1:length(z3), function(i) c(max(z3[[i]][[1]]$I), ## peak epidemic size
sum(sort(z3[[i]][[2]]$numInf,decreasing=TRUE)[1:round(0.2*nrow(z3[[i]][[2]]))])/sum(z3[[i]][[2]]$numInf), ## fraction of cases caused by top 20% of spreaders
ifelse(max(z3[[i]][[1]]$t)>99, glm.nb(z3[[i]][[2]]$numInf~1)$theta, NA), ## dispersion parameter of negative binomial distribution fit to numInf
i)) %>%
do.call("rbind.data.frame",.) %>%
mutate(., Variance="low",cov=covMatrix, traits=paste(var1[j],var2[j],sep="-")) -> z[[3]]
colnames(z[[3]])[1:4] <- c("peak","top20SS","disp","rep")
data[[i]] <- do.call("rbind.data.frame",z)
i <- i+1
}
}
data %>% do.call("rbind.data.frame",.) -> data
# order categories
data$Variance<-factor(data$Variance, levels = c("low", "med", "high"))
data$traits<-factor(data$traits, levels=c("alpha-gamma", "c-shed", "c-alpha","c-gamma", "shed-alpha", "shed-gamma"))
####### PEAK EPIDEMIC SIZE PLOTS
data<-subset(data, peak>5) # remove peaks smaller than 5
# intergroup trait pairings
ggplot(subset(data, traits%in%c("c-gamma", "shed-gamma")), aes(x=Variance, y=peak,shape=cov,fill=cov))+
geom_violin()  +
facet_grid(~traits)+
theme_bw()+
labs(y="Peak", x="Variance")+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
ggtitle("Intergroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
# intragroup trait pairings
ggplot(subset(data, traits%in%c("c-shed", "alpha-gamma")), aes(x=Variance, y=peak,shape=cov,fill=cov))+
geom_violin()  +
facet_grid(~traits)+
theme_bw()+
labs(y="Peak", x="Variance")+
scale_fill_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
ggtitle("Intragroup Trait Pairings")+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
###### EFFECT OF SUPER SPREADING ON PEAK EPIDEMIC SIZE
data<-subset(data, peak>50)
ggplot(subset(data, traits%in%c("alpha-gamma","c-shed", "shed-alpha", "shed-gamma")), aes(x=disp, y=peak, shape=Variance, color=cov))+
geom_point()+
facet_grid(~traits)+
theme_bw()+
labs(y="Peak", x="Dispersion (K)")+
scale_color_manual(values=c("cornflowerblue", "mistyrose", "sienna3"))+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
ggplot(subset(data, traits%in%c("alpha-gamma","c-shed", "shed-alpha", "shed-gamma")), aes(x=disp, y=peak, shape=Variance, color=cov))+
geom_point()+
facet_grid(~traits)+
theme_bw()+
labs(y="Peak", x="Dispersion (K)")+
scale_color_manual(values=c("cornflowerblue", "pink", "sienna3"))+
theme(text = element_text(size=15),
plot.title = element_text(hjust = 0.5),
plot.margin = margin(t = 10,  # Top margin
r = 20,  # Right margin
b = 10,  # Bottom margin
l = 40))
